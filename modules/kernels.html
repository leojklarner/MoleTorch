<!DOCTYPE html>

<html class="no-js" data-content_root="../" lang="en">
<head><meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="light dark" name="color-scheme"/><meta content="width=device-width, initial-scale=1" name="viewport">
<meta content="gauche.kernels" property="og:title"/>
<meta content="website" property="og:type"/>
<meta content="modules/kernels.html" property="og:url"/>
<meta content="GAUCHE" property="og:site_name"/>
<meta content="Fingerprint Kernels: Tanimoto Kernel. Operates on representations including bit vectors e.g. Morgan/ECFP6 fingerprints count vectors e.g. RDKit fragment features. Braun-Blanquet Kernel. Operates on..." property="og:description"/>
<meta content="1146" property="og:image:width"/>
<meta content="600" property="og:image:height"/>
<meta content="/_images/social_previews/summary_modules_kernels_a6f1fb1c.png" property="og:image"/>
<meta content="Fingerprint Kernels: Tanimoto Kernel. Operates on representations including bit vectors e.g. Morgan/ECFP6 fingerprints count vectors e.g. RDKit fragment feat..." property="og:image:alt"/>
<meta content="Fingerprint Kernels: Tanimoto Kernel. Operates on representations including bit vectors e.g. Morgan/ECFP6 fingerprints count vectors e.g. RDKit fragment features. Braun-Blanquet Kernel. Operates on..." name="description"/>
<meta content="summary_large_image" name="twitter:card"/>
<link href="../genindex.html" rel="index" title="Index"/><link href="../search.html" rel="search" title="Search"/><link href="representations.html" rel="next" title="gauche.representations"/><link href="../notebooks/bayesian_gnn_on_molecules.html" rel="prev" title="Bayesian GNNs for Molecular Property Prediction"/>
<!-- Generated with Sphinx 7.2.6 and Furo 2023.09.10 -->
<title>gauche.kernels - GAUCHE documentation</title>
<link href="../_static/pygments.css?v=a746c00c" rel="stylesheet" type="text/css"/>
<link href="../_static/styles/furo.css?v=135e06be" rel="stylesheet" type="text/css"/>
<link href="../_static/copybutton.css?v=76b2166b" rel="stylesheet" type="text/css"/>
<link href="../_static/tabs.css?v=4c969af8" rel="stylesheet" type="text/css"/>
<link href="../_static/sphinx-codeautolink.css?v=125d5c1c" rel="stylesheet" type="text/css"/>
<link href="../_static/styles/furo-extensions.css?v=36a5483c" rel="stylesheet" type="text/css"/>
<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></meta></head>
<body>
<script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
<svg style="display: none;" xmlns="http://www.w3.org/2000/svg">
<symbol id="svg-toc" viewbox="0 0 24 24">
<title>Contents</title>
<svg fill="currentColor" stroke="currentColor" stroke-width="0" viewbox="0 0 1024 1024">
<path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"></path>
</svg>
</symbol>
<symbol id="svg-menu" viewbox="0 0 24 24">
<title>Menu</title>
<svg class="feather-menu" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<line x1="3" x2="21" y1="12" y2="12"></line>
<line x1="3" x2="21" y1="6" y2="6"></line>
<line x1="3" x2="21" y1="18" y2="18"></line>
</svg>
</symbol>
<symbol id="svg-arrow-right" viewbox="0 0 24 24">
<title>Expand</title>
<svg class="feather-chevron-right" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<polyline points="9 18 15 12 9 6"></polyline>
</svg>
</symbol>
<symbol id="svg-sun" viewbox="0 0 24 24">
<title>Light mode</title>
<svg class="feather-sun" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<circle cx="12" cy="12" r="5"></circle>
<line x1="12" x2="12" y1="1" y2="3"></line>
<line x1="12" x2="12" y1="21" y2="23"></line>
<line x1="4.22" x2="5.64" y1="4.22" y2="5.64"></line>
<line x1="18.36" x2="19.78" y1="18.36" y2="19.78"></line>
<line x1="1" x2="3" y1="12" y2="12"></line>
<line x1="21" x2="23" y1="12" y2="12"></line>
<line x1="4.22" x2="5.64" y1="19.78" y2="18.36"></line>
<line x1="18.36" x2="19.78" y1="5.64" y2="4.22"></line>
</svg>
</symbol>
<symbol id="svg-moon" viewbox="0 0 24 24">
<title>Dark mode</title>
<svg class="icon-tabler-moon" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
<path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path>
</svg>
</symbol>
<symbol id="svg-sun-half" viewbox="0 0 24 24">
<title>Auto light/dark mode</title>
<svg class="icon-tabler-shadow" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0h24v24H0z" fill="none" stroke="none"></path>
<circle cx="12" cy="12" r="9"></circle>
<path d="M13 12h5"></path>
<path d="M13 15h4"></path>
<path d="M13 18h1"></path>
<path d="M13 9h4"></path>
<path d="M13 6h1"></path>
</svg>
</symbol>
</svg>
<input class="sidebar-toggle" id="__navigation" name="__navigation" type="checkbox"/>
<input class="sidebar-toggle" id="__toc" name="__toc" type="checkbox"/>
<label class="overlay sidebar-overlay" for="__navigation">
<div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
<div class="visually-hidden">Hide table of contents sidebar</div>
</label>
<div class="page">
<header class="mobile-header">
<div class="header-left">
<label class="nav-overlay-icon" for="__navigation">
<div class="visually-hidden">Toggle site navigation sidebar</div>
<i class="icon"><svg><use href="#svg-menu"></use></svg></i>
</label>
</div>
<div class="header-center">
<a href="../index.html"><div class="brand">GAUCHE  documentation</div></a>
</div>
<div class="header-right">
<div class="theme-toggle-container theme-toggle-header">
<button class="theme-toggle">
<div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
<svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
<svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
<svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
</button>
</div>
<label class="toc-overlay-icon toc-header-icon" for="__toc">
<div class="visually-hidden">Toggle table of contents sidebar</div>
<i class="icon"><svg><use href="#svg-toc"></use></svg></i>
</label>
</div>
</header>
<aside class="sidebar-drawer">
<div class="sidebar-container">
<div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
<span class="sidebar-brand-text">GAUCHE  documentation</span>
</a><form action="../search.html" class="sidebar-search-container" method="get" role="search">
<input aria-label="Search" class="sidebar-search" name="q" placeholder="Search"/>
<input name="check_keywords" type="hidden" value="yes"/>
<input name="area" type="hidden" value="default"/>
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/loading_and_featurising_molecules.html">Loading and Featurising Molecular Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/gp_regression_on_molecules.html">GP Regression on Molecules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/bayesian_optimisation_over_molecules.html">Bayesian Optimisation Over Molecules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/sparse_gp_regression_for_big_molecular_data.html">Sparse GP Regression on Molecules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/multitask_gp_regression_on_molecules.html">Multitask GP Regression on Molecules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/molecular_preference_learning.html">Learning an Objective Function through Interaction with a Human Chemist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/preferential_bayesian_optimisation.html">Preferential Bayesian Optimisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/protein_fitness_prediction_bag_of_amino_acids.html">GP Regression on Protein Sequences: Bag of Amino Acids</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/protein_fitness_prediction_ssk_gp.html">GP Regression on Protein Sequences: Subsequence String Kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks/bayesian_gnn_on_molecules.html">Bayesian GNNs for Molecular Property Prediction</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">gauche.kernels</a></li>
<li class="toctree-l1"><a class="reference internal" href="representations.html">gauche.representations</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataloader.html">gauche.dataloader</a></li>
</ul>
</div>
</div>
</div>
</div>
</aside>
<div class="main">
<div class="content">
<div class="article-container">
<a class="back-to-top muted-link" href="#">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
</svg>
<span>Back to top</span>
</a>
<div class="content-icon-container">
<div class="theme-toggle-container theme-toggle-content">
<button class="theme-toggle">
<div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
<svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
<svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
<svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
</button>
</div>
<label class="toc-overlay-icon toc-content-icon" for="__toc">
<div class="visually-hidden">Toggle table of contents sidebar</div>
<i class="icon"><svg><use href="#svg-toc"></use></svg></i>
</label>
</div>
<article role="main">
<section id="gauche-kernels">
<h1>gauche.kernels<a class="headerlink" href="#gauche-kernels" title="Link to this heading">#</a></h1>
<section id="module-gauche.kernels.fingerprint_kernels.tanimoto_kernel">
<span id="fingerprint-kernels"></span><h2>Fingerprint Kernels<a class="headerlink" href="#module-gauche.kernels.fingerprint_kernels.tanimoto_kernel" title="Link to this heading">#</a></h2>
<p>Tanimoto Kernel. Operates on representations including bit vectors e.g. Morgan/ECFP6 fingerprints count vectors e.g.
RDKit fragment features.</p>
<dl class="py class">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.tanimoto_kernel.TanimotoKernel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gauche.kernels.fingerprint_kernels.tanimoto_kernel.</span></span><span class="sig-name descname"><span class="pre">TanimotoKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/tanimoto_kernel.html#TanimotoKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.tanimoto_kernel.TanimotoKernel" title="Link to this definition">#</a></dt>
<dd><blockquote>
<div><p>Computes a covariance matrix based on the Tanimoto kernel
between inputs <span class="math notranslate nohighlight">\(\mathbf{x_1}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{x_2}\)</span>:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{equation*}
k_{\text{Tanimoto}}(\mathbf{x}, \mathbf{x'}) = \frac{\langle\mathbf{x},
\mathbf{x'}\rangle}{\left\lVert\mathbf{x}\right\rVert^2 + \left\lVert\mathbf{x'}\right\rVert^2 -
\langle\mathbf{x}, \mathbf{x'}\rangle}
\end{equation*}\]</div>
</div>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This kernel does not have an <cite>outputscale</cite> parameter. To add a scaling parameter,
decorate this kernel with a <code class="xref py py-class docutils literal notranslate"><span class="pre">gpytorch.test_kernels.ScaleKernel</span></code>.</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Non-batch: Simple option</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar_module</span> <span class="o">=</span> <span class="n">gpytorch</span><span class="o">.</span><span class="n">kernels</span><span class="o">.</span><span class="n">ScaleKernel</span><span class="p">(</span><span class="n">TanimotoKernel</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar</span> <span class="o">=</span> <span class="n">covar_module</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Output: LazyTensor of size (10 x 10)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Batch: Simple option</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar_module</span> <span class="o">=</span> <span class="n">gpytorch</span><span class="o">.</span><span class="n">kernels</span><span class="o">.</span><span class="n">ScaleKernel</span><span class="p">(</span><span class="n">TanimotoKernel</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar</span> <span class="o">=</span> <span class="n">covar_module</span><span class="p">(</span><span class="n">batch_x</span><span class="p">)</span>  <span class="c1"># Output: LazyTensor of size (2 x 10 x 10)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.tanimoto_kernel.TanimotoKernel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/tanimoto_kernel.html#TanimotoKernel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.tanimoto_kernel.TanimotoKernel.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.tanimoto_kernel.TanimotoKernel.covar_dist">
<span class="sig-name descname"><span class="pre">covar_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_dim_is_batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/tanimoto_kernel.html#TanimotoKernel.covar_dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.tanimoto_kernel.TanimotoKernel.covar_dist" title="Link to this definition">#</a></dt>
<dd><p>This is a helper method for computing the bit vector similarity between
all pairs of points in x1 and x2.</p>
<p>:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">x1</span></code>: First set of data.
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">x1</span></code>: Tensor <cite>n x d</cite> or <cite>b1 x … x bk x n x d</cite>
:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">x2</span></code>: Second set of data.
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">x2</span></code>: Tensor <cite>m x d</cite> or <cite>b1 x … x bk x m x d</cite>
:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">last_dim_is_batch</span></code>: Is the last dimension of the data a batch dimension or not?
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">last_dim_is_batch</span></code>: tuple, optional</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor)</span> <span class="pre">corresponding</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">distance</span> <span class="pre">matrix</span> <span class="pre">between</span> <span class="pre">`x1</span></code> and <cite>x2</cite>.
The shape depends on the kernel’s mode
* <cite>diag=False</cite>
* <cite>diag=False</cite> and <cite>last_dim_is_batch=True</cite>: (<cite>b x d x n x n</cite>)
* <cite>diag=True</cite>
* <cite>diag=True</cite> and <cite>last_dim_is_batch=True</cite>: (<cite>b x d x n</cite>)</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.tanimoto_kernel.TanimotoKernel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/tanimoto_kernel.html#TanimotoKernel.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.tanimoto_kernel.TanimotoKernel.forward" title="Link to this definition">#</a></dt>
<dd><p>Computes the covariance between <span class="math notranslate nohighlight">\(\mathbf x_1\)</span> and <span class="math notranslate nohighlight">\(\mathbf x_2\)</span>.
This method should be imlemented by all Kernel subclasses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> – First set of data (… x N x D).</p></li>
<li><p><strong>x2</strong> – Second set of data (… x M x D).</p></li>
<li><p><strong>diag</strong> – Should the Kernel compute the whole kernel, or just the diag?
If True, it must be the case that <cite>x1 == x2</cite>. (Default: False.)</p></li>
<li><p><strong>last_dim_is_batch</strong> – If True, treat the last dimension
of <cite>x1</cite> and <cite>x2</cite> as another batch dimension.
(Useful for additive structure over the dimensions). (Default: False.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>The kernel matrix or vector. The shape depends on the kernel’s evaluation mode:</p>
<ul class="simple">
<li><p><cite>full_covar</cite>: <cite>… x N x M</cite></p></li>
<li><p><cite>full_covar</cite> with <cite>last_dim_is_batch=True</cite>: <cite>… x K x N x M</cite></p></li>
<li><p><cite>diag</cite>: <cite>… x N</cite></p></li>
<li><p><cite>diag</cite> with <cite>last_dim_is_batch=True</cite>: <cite>… x K x N</cite></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.tanimoto_kernel.batch_tanimoto_sim">
<span class="sig-prename descclassname"><span class="pre">gauche.kernels.fingerprint_kernels.tanimoto_kernel.</span></span><span class="sig-name descname"><span class="pre">batch_tanimoto_sim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/tanimoto_kernel.html#batch_tanimoto_sim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.tanimoto_kernel.batch_tanimoto_sim" title="Link to this definition">#</a></dt>
<dd><p>Tanimoto similarity between two batched tensors, across last 2 dimensions.
eps argument ensures numerical stability if all zero tensors are added. Tanimoto similarity is proportional to:</p>
<p><span class="math notranslate nohighlight">\((&lt;x, y&gt;) / (||x||^2 + ||y||^2 - &lt;x, y&gt;)\)</span></p>
<p>where x and y may be bit or count vectors or in set notation:</p>
<p><span class="math notranslate nohighlight">\(|A \cap B| / |A| + |B| - |A \cap B|\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> – <cite>[b x n x d]</cite> Tensor where b is the batch dimension</p></li>
<li><p><strong>x2</strong> – <cite>[b x m x d]</cite> Tensor</p></li>
<li><p><strong>eps</strong> – Float for numerical stability. Default value is 1e-6</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor denoting the Tanimoto similarity.</p>
</dd>
</dl>
</dd></dl>
<p id="module-gauche.kernels.fingerprint_kernels.braun_blanquet_kernel">Braun-Blanquet Kernel. Operates on representations including bit vectors e.g. Morgan/ECFP6 fingerprints count vectors e.g.
RDKit fragment features.</p>
<dl class="py class">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.braun_blanquet_kernel.BraunBlanquetKernel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gauche.kernels.fingerprint_kernels.braun_blanquet_kernel.</span></span><span class="sig-name descname"><span class="pre">BraunBlanquetKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/braun_blanquet_kernel.html#BraunBlanquetKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.braun_blanquet_kernel.BraunBlanquetKernel" title="Link to this definition">#</a></dt>
<dd><blockquote>
<div><p>Computes a covariance matrix based on the Braun-Blanquet kernel
between inputs <span class="math notranslate nohighlight">\(\mathbf{x_1}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{x_2}\)</span>:</p>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This kernel does not have an <cite>outputscale</cite> parameter. To add a scaling parameter,
decorate this kernel with a <code class="xref py py-class docutils literal notranslate"><span class="pre">gpytorch.test_kernels.ScaleKernel</span></code>.</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Non-batch: Simple option</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar_module</span> <span class="o">=</span> <span class="n">gpytorch</span><span class="o">.</span><span class="n">kernels</span><span class="o">.</span><span class="n">ScaleKernel</span><span class="p">(</span><span class="n">BraunBlanquetKernel</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar</span> <span class="o">=</span> <span class="n">covar_module</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Output: LazyTensor of size (10 x 10)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Batch: Simple option</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar_module</span> <span class="o">=</span> <span class="n">gpytorch</span><span class="o">.</span><span class="n">kernels</span><span class="o">.</span><span class="n">ScaleKernel</span><span class="p">(</span><span class="n">BraunBlanquetKernel</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar</span> <span class="o">=</span> <span class="n">covar_module</span><span class="p">(</span><span class="n">batch_x</span><span class="p">)</span>  <span class="c1"># Output: LazyTensor of size (2 x 10 x 10)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.braun_blanquet_kernel.BraunBlanquetKernel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/braun_blanquet_kernel.html#BraunBlanquetKernel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.braun_blanquet_kernel.BraunBlanquetKernel.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.braun_blanquet_kernel.BraunBlanquetKernel.covar_dist">
<span class="sig-name descname"><span class="pre">covar_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_dim_is_batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/braun_blanquet_kernel.html#BraunBlanquetKernel.covar_dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.braun_blanquet_kernel.BraunBlanquetKernel.covar_dist" title="Link to this definition">#</a></dt>
<dd><p>This is a helper method for computing the bit vector similarity between
all pairs of points in x1 and x2.</p>
<p>:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">x1</span></code>: First set of data.
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">x1</span></code>: Tensor <cite>n x d</cite> or <cite>b1 x … x bk x n x d</cite>
:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">x2</span></code>: Second set of data.
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">x2</span></code>: Tensor <cite>m x d</cite> or <cite>b1 x … x bk x m x d</cite>
:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">last_dim_is_batch</span></code>: Is the last dimension of the data a batch dimension or not?
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">last_dim_is_batch</span></code>: tuple, optional</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor)</span> <span class="pre">corresponding</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">distance</span> <span class="pre">matrix</span> <span class="pre">between</span> <span class="pre">`x1</span></code> and <cite>x2</cite>.
The shape depends on the kernel’s mode
* <cite>diag=False</cite>
* <cite>diag=False</cite> and <cite>last_dim_is_batch=True</cite>: (<cite>b x d x n x n</cite>)
* <cite>diag=True</cite>
* <cite>diag=True</cite> and <cite>last_dim_is_batch=True</cite>: (<cite>b x d x n</cite>)</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.braun_blanquet_kernel.BraunBlanquetKernel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/braun_blanquet_kernel.html#BraunBlanquetKernel.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.braun_blanquet_kernel.BraunBlanquetKernel.forward" title="Link to this definition">#</a></dt>
<dd><p>Computes the covariance between <span class="math notranslate nohighlight">\(\mathbf x_1\)</span> and <span class="math notranslate nohighlight">\(\mathbf x_2\)</span>.
This method should be imlemented by all Kernel subclasses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> – First set of data (… x N x D).</p></li>
<li><p><strong>x2</strong> – Second set of data (… x M x D).</p></li>
<li><p><strong>diag</strong> – Should the Kernel compute the whole kernel, or just the diag?
If True, it must be the case that <cite>x1 == x2</cite>. (Default: False.)</p></li>
<li><p><strong>last_dim_is_batch</strong> – If True, treat the last dimension
of <cite>x1</cite> and <cite>x2</cite> as another batch dimension.
(Useful for additive structure over the dimensions). (Default: False.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>The kernel matrix or vector. The shape depends on the kernel’s evaluation mode:</p>
<ul class="simple">
<li><p><cite>full_covar</cite>: <cite>… x N x M</cite></p></li>
<li><p><cite>full_covar</cite> with <cite>last_dim_is_batch=True</cite>: <cite>… x K x N x M</cite></p></li>
<li><p><cite>diag</cite>: <cite>… x N</cite></p></li>
<li><p><cite>diag</cite> with <cite>last_dim_is_batch=True</cite>: <cite>… x K x N</cite></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.braun_blanquet_kernel.batch_braun_blanquet_sim">
<span class="sig-prename descclassname"><span class="pre">gauche.kernels.fingerprint_kernels.braun_blanquet_kernel.</span></span><span class="sig-name descname"><span class="pre">batch_braun_blanquet_sim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/braun_blanquet_kernel.html#batch_braun_blanquet_sim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.braun_blanquet_kernel.batch_braun_blanquet_sim" title="Link to this definition">#</a></dt>
<dd><p>Braun-Blanquet similarity between two batched tensors, across last 2 dimensions.
eps argument ensures numerical stability if all zero tensors are added.</p>
<p><span class="math notranslate nohighlight">\(&lt;x1, x2&gt; / max(|x1|, |x2|)\)</span></p>
<p>Where || is the L1 norm and &lt;.&gt; is the inner product</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> – <cite>[b x n x d]</cite> Tensor where b is the batch dimension</p></li>
<li><p><strong>x2</strong> – <cite>[b x m x d]</cite> Tensor</p></li>
<li><p><strong>eps</strong> – Float for numerical stability. Default value is 1e-6</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor denoting the Braun-Blanquet similarity.</p>
</dd>
</dl>
</dd></dl>
<p id="module-gauche.kernels.fingerprint_kernels.dice_kernel">Dice Kernel. Operates on representations including bit vectors e.g. Morgan/ECFP6 fingerprints count vectors e.g.
RDKit fragment features.</p>
<dl class="py class">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.dice_kernel.DiceKernel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gauche.kernels.fingerprint_kernels.dice_kernel.</span></span><span class="sig-name descname"><span class="pre">DiceKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/dice_kernel.html#DiceKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.dice_kernel.DiceKernel" title="Link to this definition">#</a></dt>
<dd><blockquote>
<div><p>Computes a covariance matrix based on the Dice kernel
between inputs <span class="math notranslate nohighlight">\(\mathbf{x_1}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{x_2}\)</span>:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{equation*}
k_{\text{Dice}}(\mathbf{x}, \mathbf{x'}) = \frac{2\langle\mathbf{x},
\mathbf{x'}\rangle}{\left\lVert\mathbf{x}\right\rVert + \left\lVert\mathbf{x'}\right\rVert}
\end{equation*}\]</div>
</div>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This kernel does not have an <cite>outputscale</cite> parameter. To add a scaling parameter,
decorate this kernel with a <code class="xref py py-class docutils literal notranslate"><span class="pre">gpytorch.test_kernels.ScaleKernel</span></code>.</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Non-batch: Simple option</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar_module</span> <span class="o">=</span> <span class="n">gpytorch</span><span class="o">.</span><span class="n">kernels</span><span class="o">.</span><span class="n">ScaleKernel</span><span class="p">(</span><span class="n">DiceKernel</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar</span> <span class="o">=</span> <span class="n">covar_module</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Output: LazyTensor of size (10 x 10)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Batch: Simple option</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar_module</span> <span class="o">=</span> <span class="n">gpytorch</span><span class="o">.</span><span class="n">kernels</span><span class="o">.</span><span class="n">ScaleKernel</span><span class="p">(</span><span class="n">DiceKernel</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar</span> <span class="o">=</span> <span class="n">covar_module</span><span class="p">(</span><span class="n">batch_x</span><span class="p">)</span>  <span class="c1"># Output: LazyTensor of size (2 x 10 x 10)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.dice_kernel.DiceKernel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/dice_kernel.html#DiceKernel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.dice_kernel.DiceKernel.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.dice_kernel.DiceKernel.covar_dist">
<span class="sig-name descname"><span class="pre">covar_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_dim_is_batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/dice_kernel.html#DiceKernel.covar_dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.dice_kernel.DiceKernel.covar_dist" title="Link to this definition">#</a></dt>
<dd><p>This is a helper method for computing the bit vector similarity between
all pairs of points in x1 and x2.</p>
<p>:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">x1</span></code>: First set of data.
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">x1</span></code>: Tensor <cite>n x d</cite> or <cite>b1 x … x bk x n x d</cite>
:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">x2</span></code>: Second set of data.
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">x2</span></code>: Tensor <cite>m x d</cite> or <cite>b1 x … x bk x m x d</cite>
:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">last_dim_is_batch</span></code>: Is the last dimension of the data a batch dimension or not?
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">last_dim_is_batch</span></code>: tuple, optional</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor)</span> <span class="pre">corresponding</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">distance</span> <span class="pre">matrix</span> <span class="pre">between</span> <span class="pre">`x1</span></code> and <cite>x2</cite>.
The shape depends on the kernel’s mode
* <cite>diag=False</cite>
* <cite>diag=False</cite> and <cite>last_dim_is_batch=True</cite>: (<cite>b x d x n x n</cite>)
* <cite>diag=True</cite>
* <cite>diag=True</cite> and <cite>last_dim_is_batch=True</cite>: (<cite>b x d x n</cite>)</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.dice_kernel.DiceKernel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/dice_kernel.html#DiceKernel.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.dice_kernel.DiceKernel.forward" title="Link to this definition">#</a></dt>
<dd><p>Computes the covariance between <span class="math notranslate nohighlight">\(\mathbf x_1\)</span> and <span class="math notranslate nohighlight">\(\mathbf x_2\)</span>.
This method should be imlemented by all Kernel subclasses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> – First set of data (… x N x D).</p></li>
<li><p><strong>x2</strong> – Second set of data (… x M x D).</p></li>
<li><p><strong>diag</strong> – Should the Kernel compute the whole kernel, or just the diag?
If True, it must be the case that <cite>x1 == x2</cite>. (Default: False.)</p></li>
<li><p><strong>last_dim_is_batch</strong> – If True, treat the last dimension
of <cite>x1</cite> and <cite>x2</cite> as another batch dimension.
(Useful for additive structure over the dimensions). (Default: False.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>The kernel matrix or vector. The shape depends on the kernel’s evaluation mode:</p>
<ul class="simple">
<li><p><cite>full_covar</cite>: <cite>… x N x M</cite></p></li>
<li><p><cite>full_covar</cite> with <cite>last_dim_is_batch=True</cite>: <cite>… x K x N x M</cite></p></li>
<li><p><cite>diag</cite>: <cite>… x N</cite></p></li>
<li><p><cite>diag</cite> with <cite>last_dim_is_batch=True</cite>: <cite>… x K x N</cite></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.dice_kernel.batch_dice_sim">
<span class="sig-prename descclassname"><span class="pre">gauche.kernels.fingerprint_kernels.dice_kernel.</span></span><span class="sig-name descname"><span class="pre">batch_dice_sim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/dice_kernel.html#batch_dice_sim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.dice_kernel.batch_dice_sim" title="Link to this definition">#</a></dt>
<dd><p>Dice similarity between two batched tensors, across last 2 dimensions.
eps argument ensures numerical stability if all zero tensors are added.</p>
<p><span class="math notranslate nohighlight">\((2 * &lt;x1, x2&gt;) / (|x1| + |x2|)\)</span></p>
<p>Where || is the L1 norm and &lt;.&gt; is the inner product</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> – <cite>[b x n x d]</cite> Tensor where b is the batch dimension</p></li>
<li><p><strong>x2</strong> – <cite>[b x m x d]</cite> Tensor</p></li>
<li><p><strong>eps</strong> – Float for numerical stability. Default value is 1e-6</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor denoting the Dice similarity.</p>
</dd>
</dl>
</dd></dl>
<p id="module-gauche.kernels.fingerprint_kernels.faith_kernel">Faith Kernel. Operates on representations including bit vectors e.g. Morgan/ECFP6 fingerprints count vectors e.g.
RDKit fragment features.</p>
<dl class="py class">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.faith_kernel.FaithKernel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gauche.kernels.fingerprint_kernels.faith_kernel.</span></span><span class="sig-name descname"><span class="pre">FaithKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/faith_kernel.html#FaithKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.faith_kernel.FaithKernel" title="Link to this definition">#</a></dt>
<dd><blockquote>
<div><p>Computes a covariance matrix based on the Faith kernel
between inputs <span class="math notranslate nohighlight">\(\mathbf{x_1}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{x_2}\)</span>:</p>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This kernel does not have an <cite>outputscale</cite> parameter. To add a scaling parameter,
decorate this kernel with a <code class="xref py py-class docutils literal notranslate"><span class="pre">gpytorch.test_kernels.ScaleKernel</span></code>.</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Non-batch: Simple option</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar_module</span> <span class="o">=</span> <span class="n">gpytorch</span><span class="o">.</span><span class="n">kernels</span><span class="o">.</span><span class="n">ScaleKernel</span><span class="p">(</span><span class="n">FaithKernel</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar</span> <span class="o">=</span> <span class="n">covar_module</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Output: LazyTensor of size (10 x 10)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Batch: Simple option</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar_module</span> <span class="o">=</span> <span class="n">gpytorch</span><span class="o">.</span><span class="n">kernels</span><span class="o">.</span><span class="n">ScaleKernel</span><span class="p">(</span><span class="n">FaithKernel</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar</span> <span class="o">=</span> <span class="n">covar_module</span><span class="p">(</span><span class="n">batch_x</span><span class="p">)</span>  <span class="c1"># Output: LazyTensor of size (2 x 10 x 10)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.faith_kernel.FaithKernel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/faith_kernel.html#FaithKernel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.faith_kernel.FaithKernel.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.faith_kernel.FaithKernel.covar_dist">
<span class="sig-name descname"><span class="pre">covar_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_dim_is_batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/faith_kernel.html#FaithKernel.covar_dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.faith_kernel.FaithKernel.covar_dist" title="Link to this definition">#</a></dt>
<dd><p>This is a helper method for computing the bit vector similarity between
all pairs of points in x1 and x2.</p>
<p>:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">x1</span></code>: First set of data.
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">x1</span></code>: Tensor <cite>n x d</cite> or <cite>b1 x … x bk x n x d</cite>
:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">x2</span></code>: Second set of data.
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">x2</span></code>: Tensor <cite>m x d</cite> or <cite>b1 x … x bk x m x d</cite>
:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">last_dim_is_batch</span></code>: Is the last dimension of the data a batch dimension or not?
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">last_dim_is_batch</span></code>: tuple, optional</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor)</span> <span class="pre">corresponding</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">distance</span> <span class="pre">matrix</span> <span class="pre">between</span> <span class="pre">`x1</span></code> and <cite>x2</cite>.
The shape depends on the kernel’s mode
* <cite>diag=False</cite>
* <cite>diag=False</cite> and <cite>last_dim_is_batch=True</cite>: (<cite>b x d x n x n</cite>)
* <cite>diag=True</cite>
* <cite>diag=True</cite> and <cite>last_dim_is_batch=True</cite>: (<cite>b x d x n</cite>)</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.faith_kernel.FaithKernel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/faith_kernel.html#FaithKernel.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.faith_kernel.FaithKernel.forward" title="Link to this definition">#</a></dt>
<dd><p>Computes the covariance between <span class="math notranslate nohighlight">\(\mathbf x_1\)</span> and <span class="math notranslate nohighlight">\(\mathbf x_2\)</span>.
This method should be imlemented by all Kernel subclasses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> – First set of data (… x N x D).</p></li>
<li><p><strong>x2</strong> – Second set of data (… x M x D).</p></li>
<li><p><strong>diag</strong> – Should the Kernel compute the whole kernel, or just the diag?
If True, it must be the case that <cite>x1 == x2</cite>. (Default: False.)</p></li>
<li><p><strong>last_dim_is_batch</strong> – If True, treat the last dimension
of <cite>x1</cite> and <cite>x2</cite> as another batch dimension.
(Useful for additive structure over the dimensions). (Default: False.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>The kernel matrix or vector. The shape depends on the kernel’s evaluation mode:</p>
<ul class="simple">
<li><p><cite>full_covar</cite>: <cite>… x N x M</cite></p></li>
<li><p><cite>full_covar</cite> with <cite>last_dim_is_batch=True</cite>: <cite>… x K x N x M</cite></p></li>
<li><p><cite>diag</cite>: <cite>… x N</cite></p></li>
<li><p><cite>diag</cite> with <cite>last_dim_is_batch=True</cite>: <cite>… x K x N</cite></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.faith_kernel.batch_faith_sim">
<span class="sig-prename descclassname"><span class="pre">gauche.kernels.fingerprint_kernels.faith_kernel.</span></span><span class="sig-name descname"><span class="pre">batch_faith_sim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/faith_kernel.html#batch_faith_sim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.faith_kernel.batch_faith_sim" title="Link to this definition">#</a></dt>
<dd><p>Faith similarity between two batched tensors, across last 2 dimensions.
eps argument ensures numerical stability if all zero tensors are added.</p>
<p><span class="math notranslate nohighlight">\((2 * &lt;x1, x2&gt;) + d / 2n\)</span></p>
<p>Where &lt;.&gt; is the inner product, d is the number of common zeros and n is the dimension of the input vectors</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> – <cite>[b x n x d]</cite> Tensor where b is the batch dimension</p></li>
<li><p><strong>x2</strong> – <cite>[b x m x d]</cite> Tensor</p></li>
<li><p><strong>eps</strong> – Float for numerical stability. Default value is 1e-6</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor denoting the Faith similarity.</p>
</dd>
</dl>
</dd></dl>
<p id="module-gauche.kernels.fingerprint_kernels.forbes_kernel">Forbes Kernel. Operates on representations including bit vectors e.g. Morgan/ECFP6 fingerprints count vectors e.g.
RDKit fragment features.</p>
<dl class="py class">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.forbes_kernel.ForbesKernel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gauche.kernels.fingerprint_kernels.forbes_kernel.</span></span><span class="sig-name descname"><span class="pre">ForbesKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/forbes_kernel.html#ForbesKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.forbes_kernel.ForbesKernel" title="Link to this definition">#</a></dt>
<dd><blockquote>
<div><p>Computes a covariance matrix based on the Forbes kernel
between inputs <span class="math notranslate nohighlight">\(\mathbf{x_1}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{x_2}\)</span>:</p>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This kernel does not have an <cite>outputscale</cite> parameter. To add a scaling parameter,
decorate this kernel with a <code class="xref py py-class docutils literal notranslate"><span class="pre">gpytorch.test_kernels.ScaleKernel</span></code>.</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Non-batch: Simple option</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar_module</span> <span class="o">=</span> <span class="n">gpytorch</span><span class="o">.</span><span class="n">kernels</span><span class="o">.</span><span class="n">ScaleKernel</span><span class="p">(</span><span class="n">ForbesKernel</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar</span> <span class="o">=</span> <span class="n">covar_module</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Output: LazyTensor of size (10 x 10)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Batch: Simple option</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar_module</span> <span class="o">=</span> <span class="n">gpytorch</span><span class="o">.</span><span class="n">kernels</span><span class="o">.</span><span class="n">ScaleKernel</span><span class="p">(</span><span class="n">ForbesKernel</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar</span> <span class="o">=</span> <span class="n">covar_module</span><span class="p">(</span><span class="n">batch_x</span><span class="p">)</span>  <span class="c1"># Output: LazyTensor of size (2 x 10 x 10)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.forbes_kernel.ForbesKernel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/forbes_kernel.html#ForbesKernel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.forbes_kernel.ForbesKernel.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.forbes_kernel.ForbesKernel.covar_dist">
<span class="sig-name descname"><span class="pre">covar_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_dim_is_batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/forbes_kernel.html#ForbesKernel.covar_dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.forbes_kernel.ForbesKernel.covar_dist" title="Link to this definition">#</a></dt>
<dd><p>This is a helper method for computing the bit vector similarity between
all pairs of points in x1 and x2.</p>
<p>:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">x1</span></code>: First set of data.
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">x1</span></code>: Tensor <cite>n x d</cite> or <cite>b1 x … x bk x n x d</cite>
:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">x2</span></code>: Second set of data.
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">x2</span></code>: Tensor <cite>m x d</cite> or <cite>b1 x … x bk x m x d</cite>
:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">last_dim_is_batch</span></code>: Is the last dimension of the data a batch dimension or not?
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">last_dim_is_batch</span></code>: tuple, optional</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor)</span> <span class="pre">corresponding</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">distance</span> <span class="pre">matrix</span> <span class="pre">between</span> <span class="pre">`x1</span></code> and <cite>x2</cite>.
The shape depends on the kernel’s mode
* <cite>diag=False</cite>
* <cite>diag=False</cite> and <cite>last_dim_is_batch=True</cite>: (<cite>b x d x n x n</cite>)
* <cite>diag=True</cite>
* <cite>diag=True</cite> and <cite>last_dim_is_batch=True</cite>: (<cite>b x d x n</cite>)</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.forbes_kernel.ForbesKernel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/forbes_kernel.html#ForbesKernel.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.forbes_kernel.ForbesKernel.forward" title="Link to this definition">#</a></dt>
<dd><p>Computes the covariance between <span class="math notranslate nohighlight">\(\mathbf x_1\)</span> and <span class="math notranslate nohighlight">\(\mathbf x_2\)</span>.
This method should be imlemented by all Kernel subclasses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> – First set of data (… x N x D).</p></li>
<li><p><strong>x2</strong> – Second set of data (… x M x D).</p></li>
<li><p><strong>diag</strong> – Should the Kernel compute the whole kernel, or just the diag?
If True, it must be the case that <cite>x1 == x2</cite>. (Default: False.)</p></li>
<li><p><strong>last_dim_is_batch</strong> – If True, treat the last dimension
of <cite>x1</cite> and <cite>x2</cite> as another batch dimension.
(Useful for additive structure over the dimensions). (Default: False.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>The kernel matrix or vector. The shape depends on the kernel’s evaluation mode:</p>
<ul class="simple">
<li><p><cite>full_covar</cite>: <cite>… x N x M</cite></p></li>
<li><p><cite>full_covar</cite> with <cite>last_dim_is_batch=True</cite>: <cite>… x K x N x M</cite></p></li>
<li><p><cite>diag</cite>: <cite>… x N</cite></p></li>
<li><p><cite>diag</cite> with <cite>last_dim_is_batch=True</cite>: <cite>… x K x N</cite></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.forbes_kernel.batch_forbes_sim">
<span class="sig-prename descclassname"><span class="pre">gauche.kernels.fingerprint_kernels.forbes_kernel.</span></span><span class="sig-name descname"><span class="pre">batch_forbes_sim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/forbes_kernel.html#batch_forbes_sim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.forbes_kernel.batch_forbes_sim" title="Link to this definition">#</a></dt>
<dd><p>Forbes similarity between two batched tensors, across last 2 dimensions.
eps argument ensures numerical stability if all zero tensors are added.</p>
<p><span class="math notranslate nohighlight">\(n * &lt;x1, x2&gt; / (|x1| + |x2|)\)</span></p>
<p>Where &lt;.&gt; is the inner product, <span class="math notranslate nohighlight">\(||\)</span> is the L1 norm, and n is the dimension of the input vectors</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> – <cite>[b x n x d]</cite> Tensor where b is the batch dimension</p></li>
<li><p><strong>x2</strong> – <cite>[b x m x d]</cite> Tensor</p></li>
<li><p><strong>eps</strong> – Float for numerical stability. Default value is 1e-6</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor denoting the Forbes similarity.</p>
</dd>
</dl>
</dd></dl>
<p id="module-gauche.kernels.fingerprint_kernels.inner_product_kernel">Inner Product Kernel. Operates on representations including bit vectors e.g. Morgan/ECFP6 fingerprints count vectors e.g.
RDKit fragment features.</p>
<dl class="py class">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.inner_product_kernel.InnerProductKernel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gauche.kernels.fingerprint_kernels.inner_product_kernel.</span></span><span class="sig-name descname"><span class="pre">InnerProductKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/inner_product_kernel.html#InnerProductKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.inner_product_kernel.InnerProductKernel" title="Link to this definition">#</a></dt>
<dd><blockquote>
<div><p>Computes a covariance matrix based on the inner product kernel
between inputs <span class="math notranslate nohighlight">\(\mathbf{x_1}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{x_2}\)</span>:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{equation*}
k_{\text{Inner Product}}(\mathbf{x}, \mathbf{x'}) = \langle\mathbf{x},
\mathbf{x'}\rangle
\end{equation*}\]</div>
</div>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This kernel does not have an <cite>outputscale</cite> parameter. To add a scaling parameter,
decorate this kernel with a <code class="xref py py-class docutils literal notranslate"><span class="pre">gpytorch.test_kernels.ScaleKernel</span></code>.</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Non-batch: Simple option</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar_module</span> <span class="o">=</span> <span class="n">gpytorch</span><span class="o">.</span><span class="n">kernels</span><span class="o">.</span><span class="n">ScaleKernel</span><span class="p">(</span><span class="n">InnerProductKernel</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar</span> <span class="o">=</span> <span class="n">covar_module</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Output: LazyTensor of size (10 x 10)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Batch: Simple option</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar_module</span> <span class="o">=</span> <span class="n">gpytorch</span><span class="o">.</span><span class="n">kernels</span><span class="o">.</span><span class="n">ScaleKernel</span><span class="p">(</span><span class="n">InnerProductKernel</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar</span> <span class="o">=</span> <span class="n">covar_module</span><span class="p">(</span><span class="n">batch_x</span><span class="p">)</span>  <span class="c1"># Output: LazyTensor of size (2 x 10 x 10)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.inner_product_kernel.InnerProductKernel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/inner_product_kernel.html#InnerProductKernel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.inner_product_kernel.InnerProductKernel.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.inner_product_kernel.InnerProductKernel.covar_dist">
<span class="sig-name descname"><span class="pre">covar_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_dim_is_batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/inner_product_kernel.html#InnerProductKernel.covar_dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.inner_product_kernel.InnerProductKernel.covar_dist" title="Link to this definition">#</a></dt>
<dd><p>This is a helper method for computing the bit vector similarity between
all pairs of points in x1 and x2.</p>
<p>:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">x1</span></code>: First set of data.
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">x1</span></code>: Tensor <cite>n x d</cite> or <cite>b1 x … x bk x n x d</cite>
:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">x2</span></code>: Second set of data.
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">x2</span></code>: Tensor <cite>m x d</cite> or <cite>b1 x … x bk x m x d</cite>
:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">last_dim_is_batch</span></code>: Is the last dimension of the data a batch dimension or not?
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">last_dim_is_batch</span></code>: tuple, optional</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor)</span> <span class="pre">corresponding</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">distance</span> <span class="pre">matrix</span> <span class="pre">between</span> <span class="pre">`x1</span></code> and <cite>x2</cite>.
The shape depends on the kernel’s mode
* <cite>diag=False</cite>
* <cite>diag=False</cite> and <cite>last_dim_is_batch=True</cite>: (<cite>b x d x n x n</cite>)
* <cite>diag=True</cite>
* <cite>diag=True</cite> and <cite>last_dim_is_batch=True</cite>: (<cite>b x d x n</cite>)</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.inner_product_kernel.InnerProductKernel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/inner_product_kernel.html#InnerProductKernel.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.inner_product_kernel.InnerProductKernel.forward" title="Link to this definition">#</a></dt>
<dd><p>Computes the covariance between <span class="math notranslate nohighlight">\(\mathbf x_1\)</span> and <span class="math notranslate nohighlight">\(\mathbf x_2\)</span>.
This method should be imlemented by all Kernel subclasses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> – First set of data (… x N x D).</p></li>
<li><p><strong>x2</strong> – Second set of data (… x M x D).</p></li>
<li><p><strong>diag</strong> – Should the Kernel compute the whole kernel, or just the diag?
If True, it must be the case that <cite>x1 == x2</cite>. (Default: False.)</p></li>
<li><p><strong>last_dim_is_batch</strong> – If True, treat the last dimension
of <cite>x1</cite> and <cite>x2</cite> as another batch dimension.
(Useful for additive structure over the dimensions). (Default: False.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>The kernel matrix or vector. The shape depends on the kernel’s evaluation mode:</p>
<ul class="simple">
<li><p><cite>full_covar</cite>: <cite>… x N x M</cite></p></li>
<li><p><cite>full_covar</cite> with <cite>last_dim_is_batch=True</cite>: <cite>… x K x N x M</cite></p></li>
<li><p><cite>diag</cite>: <cite>… x N</cite></p></li>
<li><p><cite>diag</cite> with <cite>last_dim_is_batch=True</cite>: <cite>… x K x N</cite></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.inner_product_kernel.batch_inner_product_sim">
<span class="sig-prename descclassname"><span class="pre">gauche.kernels.fingerprint_kernels.inner_product_kernel.</span></span><span class="sig-name descname"><span class="pre">batch_inner_product_sim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/inner_product_kernel.html#batch_inner_product_sim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.inner_product_kernel.batch_inner_product_sim" title="Link to this definition">#</a></dt>
<dd><p>Inner product similarity between two batched tensors, across last 2 dimensions.
eps argument ensures numerical stability if all zero tensors are added.</p>
<p><span class="math notranslate nohighlight">\(&lt;x1, x2&gt;\)</span></p>
<p>Where &lt;.&gt; is the inner product</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> – <cite>[b x n x d]</cite> Tensor where b is the batch dimension</p></li>
<li><p><strong>x2</strong> – <cite>[b x m x d]</cite> Tensor</p></li>
<li><p><strong>eps</strong> – Float for numerical stability. Default value is 1e-6</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor denoting the inner product similarity.</p>
</dd>
</dl>
</dd></dl>
<p id="module-gauche.kernels.fingerprint_kernels.intersection_kernel">Intersection Kernel. Operates on representations including bit vectors e.g. Morgan/ECFP6 fingerprints count vectors e.g.
RDKit fragment features.</p>
<dl class="py class">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.intersection_kernel.IntersectionKernel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gauche.kernels.fingerprint_kernels.intersection_kernel.</span></span><span class="sig-name descname"><span class="pre">IntersectionKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/intersection_kernel.html#IntersectionKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.intersection_kernel.IntersectionKernel" title="Link to this definition">#</a></dt>
<dd><blockquote>
<div><p>Computes a covariance matrix based on the Intersection kernel
between inputs <span class="math notranslate nohighlight">\(\mathbf{x_1}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{x_2}\)</span>:</p>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This kernel does not have an <cite>outputscale</cite> parameter. To add a scaling parameter,
decorate this kernel with a <code class="xref py py-class docutils literal notranslate"><span class="pre">gpytorch.test_kernels.ScaleKernel</span></code>.</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Non-batch: Simple option</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar_module</span> <span class="o">=</span> <span class="n">gpytorch</span><span class="o">.</span><span class="n">kernels</span><span class="o">.</span><span class="n">ScaleKernel</span><span class="p">(</span><span class="n">IntersectionKernel</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar</span> <span class="o">=</span> <span class="n">covar_module</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Output: LazyTensor of size (10 x 10)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Batch: Simple option</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar_module</span> <span class="o">=</span> <span class="n">gpytorch</span><span class="o">.</span><span class="n">kernels</span><span class="o">.</span><span class="n">ScaleKernel</span><span class="p">(</span><span class="n">IntersectionKernel</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar</span> <span class="o">=</span> <span class="n">covar_module</span><span class="p">(</span><span class="n">batch_x</span><span class="p">)</span>  <span class="c1"># Output: LazyTensor of size (2 x 10 x 10)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.intersection_kernel.IntersectionKernel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/intersection_kernel.html#IntersectionKernel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.intersection_kernel.IntersectionKernel.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.intersection_kernel.IntersectionKernel.covar_dist">
<span class="sig-name descname"><span class="pre">covar_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_dim_is_batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/intersection_kernel.html#IntersectionKernel.covar_dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.intersection_kernel.IntersectionKernel.covar_dist" title="Link to this definition">#</a></dt>
<dd><p>This is a helper method for computing the bit vector similarity between
all pairs of points in x1 and x2.</p>
<p>:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">x1</span></code>: First set of data.
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">x1</span></code>: Tensor <cite>n x d</cite> or <cite>b1 x … x bk x n x d</cite>
:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">x2</span></code>: Second set of data.
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">x2</span></code>: Tensor <cite>m x d</cite> or <cite>b1 x … x bk x m x d</cite>
:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">last_dim_is_batch</span></code>: Is the last dimension of the data a batch dimension or not?
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">last_dim_is_batch</span></code>: tuple, optional</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor)</span> <span class="pre">corresponding</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">distance</span> <span class="pre">matrix</span> <span class="pre">between</span> <span class="pre">`x1</span></code> and <cite>x2</cite>.
The shape depends on the kernel’s mode
* <cite>diag=False</cite>
* <cite>diag=False</cite> and <cite>last_dim_is_batch=True</cite>: (<cite>b x d x n x n</cite>)
* <cite>diag=True</cite>
* <cite>diag=True</cite> and <cite>last_dim_is_batch=True</cite>: (<cite>b x d x n</cite>)</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.intersection_kernel.IntersectionKernel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/intersection_kernel.html#IntersectionKernel.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.intersection_kernel.IntersectionKernel.forward" title="Link to this definition">#</a></dt>
<dd><p>Computes the covariance between <span class="math notranslate nohighlight">\(\mathbf x_1\)</span> and <span class="math notranslate nohighlight">\(\mathbf x_2\)</span>.
This method should be imlemented by all Kernel subclasses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> – First set of data (… x N x D).</p></li>
<li><p><strong>x2</strong> – Second set of data (… x M x D).</p></li>
<li><p><strong>diag</strong> – Should the Kernel compute the whole kernel, or just the diag?
If True, it must be the case that <cite>x1 == x2</cite>. (Default: False.)</p></li>
<li><p><strong>last_dim_is_batch</strong> – If True, treat the last dimension
of <cite>x1</cite> and <cite>x2</cite> as another batch dimension.
(Useful for additive structure over the dimensions). (Default: False.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>The kernel matrix or vector. The shape depends on the kernel’s evaluation mode:</p>
<ul class="simple">
<li><p><cite>full_covar</cite>: <cite>… x N x M</cite></p></li>
<li><p><cite>full_covar</cite> with <cite>last_dim_is_batch=True</cite>: <cite>… x K x N x M</cite></p></li>
<li><p><cite>diag</cite>: <cite>… x N</cite></p></li>
<li><p><cite>diag</cite> with <cite>last_dim_is_batch=True</cite>: <cite>… x K x N</cite></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.intersection_kernel.batch_intersection_sim">
<span class="sig-prename descclassname"><span class="pre">gauche.kernels.fingerprint_kernels.intersection_kernel.</span></span><span class="sig-name descname"><span class="pre">batch_intersection_sim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/intersection_kernel.html#batch_intersection_sim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.intersection_kernel.batch_intersection_sim" title="Link to this definition">#</a></dt>
<dd><p>Intersection similarity between two batched tensors, across last 2 dimensions.
eps argument ensures numerical stability if all zero tensors are added. Must be
used with binary-valued vectors only</p>
<p><span class="math notranslate nohighlight">\(&lt;x1, x2&gt; + &lt;x1', x2'&gt;\)</span></p>
<p>Where &lt;.&gt; is the inner product and x1’ and x2’ denote the bit flipped vectors such
that ones and zeros are interchanged</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> – <cite>[b x n x d]</cite> Tensor where b is the batch dimension</p></li>
<li><p><strong>x2</strong> – <cite>[b x m x d]</cite> Tensor</p></li>
<li><p><strong>eps</strong> – Float for numerical stability. Default value is 1e-6</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor denoting the Intersection similarity.</p>
</dd>
</dl>
</dd></dl>
<p id="module-gauche.kernels.fingerprint_kernels.minmax_kernel">MinMax Kernel. Operates on representations including bit vectors e.g. Morgan/ECFP6 fingerprints count vectors e.g.
RDKit fragment features.</p>
<dl class="py class">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.minmax_kernel.MinMaxKernel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gauche.kernels.fingerprint_kernels.minmax_kernel.</span></span><span class="sig-name descname"><span class="pre">MinMaxKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/minmax_kernel.html#MinMaxKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.minmax_kernel.MinMaxKernel" title="Link to this definition">#</a></dt>
<dd><blockquote>
<div><p>Computes a covariance matrix based on the MinMax kernel
between inputs <span class="math notranslate nohighlight">\(\mathbf{x_1}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{x_2}\)</span>:</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\begin{equation*}
k_{\text{MinMax}}(\mathbf{x}, \mathbf{x'}) = \frac{\sum_i \min(x_i, x'_i)}
\end{equation*}\]</div>
</div>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This kernel does not have an <cite>outputscale</cite> parameter. To add a scaling parameter,
decorate this kernel with a <code class="xref py py-class docutils literal notranslate"><span class="pre">gpytorch.test_kernels.ScaleKernel</span></code>.</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Non-batch: Simple option</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar_module</span> <span class="o">=</span> <span class="n">gpytorch</span><span class="o">.</span><span class="n">kernels</span><span class="o">.</span><span class="n">ScaleKernel</span><span class="p">(</span><span class="n">MinMaxKernel</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar</span> <span class="o">=</span> <span class="n">covar_module</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Output: LazyTensor of size (10 x 10)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Batch: Simple option</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar_module</span> <span class="o">=</span> <span class="n">gpytorch</span><span class="o">.</span><span class="n">kernels</span><span class="o">.</span><span class="n">ScaleKernel</span><span class="p">(</span><span class="n">MinMaxKernel</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar</span> <span class="o">=</span> <span class="n">covar_module</span><span class="p">(</span><span class="n">batch_x</span><span class="p">)</span>  <span class="c1"># Output: LazyTensor of size (2 x 10 x 10)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.minmax_kernel.MinMaxKernel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/minmax_kernel.html#MinMaxKernel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.minmax_kernel.MinMaxKernel.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.minmax_kernel.MinMaxKernel.covar_dist">
<span class="sig-name descname"><span class="pre">covar_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_dim_is_batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/minmax_kernel.html#MinMaxKernel.covar_dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.minmax_kernel.MinMaxKernel.covar_dist" title="Link to this definition">#</a></dt>
<dd><p>This is a helper method for computing the bit vector similarity between
all pairs of points in x1 and x2.</p>
<p>:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">x1</span></code>: First set of data.
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">x1</span></code>: Tensor <cite>n x d</cite> or <cite>b1 x … x bk x n x d</cite>
:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">x2</span></code>: Second set of data.
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">x2</span></code>: Tensor <cite>m x d</cite> or <cite>b1 x … x bk x m x d</cite>
:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">last_dim_is_batch</span></code>: Is the last dimension of the data a batch dimension or not?
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">last_dim_is_batch</span></code>: tuple, optional</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor)</span> <span class="pre">corresponding</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">distance</span> <span class="pre">matrix</span> <span class="pre">between</span> <span class="pre">`x1</span></code> and <cite>x2</cite>.
The shape depends on the kernel’s mode
* <cite>diag=False</cite>
* <cite>diag=False</cite> and <cite>last_dim_is_batch=True</cite>: (<cite>b x d x n x n</cite>)
* <cite>diag=True</cite>
* <cite>diag=True</cite> and <cite>last_dim_is_batch=True</cite>: (<cite>b x d x n</cite>)</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.minmax_kernel.MinMaxKernel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/minmax_kernel.html#MinMaxKernel.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.minmax_kernel.MinMaxKernel.forward" title="Link to this definition">#</a></dt>
<dd><p>Computes the covariance between <span class="math notranslate nohighlight">\(\mathbf x_1\)</span> and <span class="math notranslate nohighlight">\(\mathbf x_2\)</span>.
This method should be imlemented by all Kernel subclasses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> – First set of data (… x N x D).</p></li>
<li><p><strong>x2</strong> – Second set of data (… x M x D).</p></li>
<li><p><strong>diag</strong> – Should the Kernel compute the whole kernel, or just the diag?
If True, it must be the case that <cite>x1 == x2</cite>. (Default: False.)</p></li>
<li><p><strong>last_dim_is_batch</strong> – If True, treat the last dimension
of <cite>x1</cite> and <cite>x2</cite> as another batch dimension.
(Useful for additive structure over the dimensions). (Default: False.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>The kernel matrix or vector. The shape depends on the kernel’s evaluation mode:</p>
<ul class="simple">
<li><p><cite>full_covar</cite>: <cite>… x N x M</cite></p></li>
<li><p><cite>full_covar</cite> with <cite>last_dim_is_batch=True</cite>: <cite>… x K x N x M</cite></p></li>
<li><p><cite>diag</cite>: <cite>… x N</cite></p></li>
<li><p><cite>diag</cite> with <cite>last_dim_is_batch=True</cite>: <cite>… x K x N</cite></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.minmax_kernel.batch_minmax_sim">
<span class="sig-prename descclassname"><span class="pre">gauche.kernels.fingerprint_kernels.minmax_kernel.</span></span><span class="sig-name descname"><span class="pre">batch_minmax_sim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/minmax_kernel.html#batch_minmax_sim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.minmax_kernel.batch_minmax_sim" title="Link to this definition">#</a></dt>
<dd><p>MinMax similarity between two batched tensors, across last 2 dimensions.
eps argument ensures numerical stability if all zero tensors are added.</p>
<p><span class="math notranslate nohighlight">\((|x1| + |x2| - |x1 - x2|) / (|x1| + |x2| + |x1 - x2|)\)</span></p>
<p>Where <span class="math notranslate nohighlight">\(||\)</span> is the L1 norm</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> – <cite>[b x n x d]</cite> Tensor where b is the batch dimension</p></li>
<li><p><strong>x2</strong> – <cite>[b x m x d]</cite> Tensor</p></li>
<li><p><strong>eps</strong> – Float for numerical stability. Default value is 1e-6</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor denoting the MinMax similarity.</p>
</dd>
</dl>
</dd></dl>
<p id="module-gauche.kernels.fingerprint_kernels.otsuka_kernel">Otsuka Kernel. Operates on representations including bit vectors e.g. Morgan/ECFP6 fingerprints count vectors e.g.
RDKit fragment features.</p>
<dl class="py class">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.otsuka_kernel.OtsukaKernel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gauche.kernels.fingerprint_kernels.otsuka_kernel.</span></span><span class="sig-name descname"><span class="pre">OtsukaKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/otsuka_kernel.html#OtsukaKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.otsuka_kernel.OtsukaKernel" title="Link to this definition">#</a></dt>
<dd><blockquote>
<div><p>Computes a covariance matrix based on the Otsuka kernel
between inputs <span class="math notranslate nohighlight">\(\mathbf{x_1}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{x_2}\)</span>:</p>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This kernel does not have an <cite>outputscale</cite> parameter. To add a scaling parameter,
decorate this kernel with a <code class="xref py py-class docutils literal notranslate"><span class="pre">gpytorch.test_kernels.ScaleKernel</span></code>.</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Non-batch: Simple option</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar_module</span> <span class="o">=</span> <span class="n">gpytorch</span><span class="o">.</span><span class="n">kernels</span><span class="o">.</span><span class="n">ScaleKernel</span><span class="p">(</span><span class="n">OtsukaKernel</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar</span> <span class="o">=</span> <span class="n">covar_module</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Output: LazyTensor of size (10 x 10)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Batch: Simple option</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar_module</span> <span class="o">=</span> <span class="n">gpytorch</span><span class="o">.</span><span class="n">kernels</span><span class="o">.</span><span class="n">ScaleKernel</span><span class="p">(</span><span class="n">OtsukaKernel</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar</span> <span class="o">=</span> <span class="n">covar_module</span><span class="p">(</span><span class="n">batch_x</span><span class="p">)</span>  <span class="c1"># Output: LazyTensor of size (2 x 10 x 10)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.otsuka_kernel.OtsukaKernel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/otsuka_kernel.html#OtsukaKernel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.otsuka_kernel.OtsukaKernel.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.otsuka_kernel.OtsukaKernel.covar_dist">
<span class="sig-name descname"><span class="pre">covar_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_dim_is_batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/otsuka_kernel.html#OtsukaKernel.covar_dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.otsuka_kernel.OtsukaKernel.covar_dist" title="Link to this definition">#</a></dt>
<dd><p>This is a helper method for computing the bit vector similarity between
all pairs of points in x1 and x2.</p>
<p>:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">x1</span></code>: First set of data.
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">x1</span></code>: Tensor <cite>n x d</cite> or <cite>b1 x … x bk x n x d</cite>
:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">x2</span></code>: Second set of data.
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">x2</span></code>: Tensor <cite>m x d</cite> or <cite>b1 x … x bk x m x d</cite>
:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">last_dim_is_batch</span></code>: Is the last dimension of the data a batch dimension or not?
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">last_dim_is_batch</span></code>: tuple, optional</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor)</span> <span class="pre">corresponding</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">distance</span> <span class="pre">matrix</span> <span class="pre">between</span> <span class="pre">`x1</span></code> and <cite>x2</cite>.
The shape depends on the kernel’s mode
* <cite>diag=False</cite>
* <cite>diag=False</cite> and <cite>last_dim_is_batch=True</cite>: (<cite>b x d x n x n</cite>)
* <cite>diag=True</cite>
* <cite>diag=True</cite> and <cite>last_dim_is_batch=True</cite>: (<cite>b x d x n</cite>)</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.otsuka_kernel.OtsukaKernel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/otsuka_kernel.html#OtsukaKernel.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.otsuka_kernel.OtsukaKernel.forward" title="Link to this definition">#</a></dt>
<dd><p>Computes the covariance between <span class="math notranslate nohighlight">\(\mathbf x_1\)</span> and <span class="math notranslate nohighlight">\(\mathbf x_2\)</span>.
This method should be imlemented by all Kernel subclasses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> – First set of data (… x N x D).</p></li>
<li><p><strong>x2</strong> – Second set of data (… x M x D).</p></li>
<li><p><strong>diag</strong> – Should the Kernel compute the whole kernel, or just the diag?
If True, it must be the case that <cite>x1 == x2</cite>. (Default: False.)</p></li>
<li><p><strong>last_dim_is_batch</strong> – If True, treat the last dimension
of <cite>x1</cite> and <cite>x2</cite> as another batch dimension.
(Useful for additive structure over the dimensions). (Default: False.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>The kernel matrix or vector. The shape depends on the kernel’s evaluation mode:</p>
<ul class="simple">
<li><p><cite>full_covar</cite>: <cite>… x N x M</cite></p></li>
<li><p><cite>full_covar</cite> with <cite>last_dim_is_batch=True</cite>: <cite>… x K x N x M</cite></p></li>
<li><p><cite>diag</cite>: <cite>… x N</cite></p></li>
<li><p><cite>diag</cite> with <cite>last_dim_is_batch=True</cite>: <cite>… x K x N</cite></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.otsuka_kernel.batch_otsuka_sim">
<span class="sig-prename descclassname"><span class="pre">gauche.kernels.fingerprint_kernels.otsuka_kernel.</span></span><span class="sig-name descname"><span class="pre">batch_otsuka_sim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/otsuka_kernel.html#batch_otsuka_sim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.otsuka_kernel.batch_otsuka_sim" title="Link to this definition">#</a></dt>
<dd><p>Otsuka similarity between two batched tensors, across last 2 dimensions.
eps argument ensures numerical stability if all zero tensors are added.</p>
<p><span class="math notranslate nohighlight">\(&lt;x1, x2&gt; / sqrt(|x1| + |x2|)\)</span></p>
<p>Where || is the L1 norm and &lt;.&gt; is the inner product</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> – <cite>[b x n x d]</cite> Tensor where b is the batch dimension</p></li>
<li><p><strong>x2</strong> – <cite>[b x m x d]</cite> Tensor</p></li>
<li><p><strong>eps</strong> – Float for numerical stability. Default value is 1e-6</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor denoting the Otsuka similarity.</p>
</dd>
</dl>
</dd></dl>
<p id="module-gauche.kernels.fingerprint_kernels.rand_kernel">Rand Kernel. Operates on representations including bit vectors e.g. Morgan/ECFP6 fingerprints count vectors e.g.
RDKit fragment features.</p>
<dl class="py class">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.rand_kernel.RandKernel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gauche.kernels.fingerprint_kernels.rand_kernel.</span></span><span class="sig-name descname"><span class="pre">RandKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/rand_kernel.html#RandKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.rand_kernel.RandKernel" title="Link to this definition">#</a></dt>
<dd><blockquote>
<div><p>Computes a covariance matrix based on the Rand kernel
between inputs <span class="math notranslate nohighlight">\(\mathbf{x_1}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{x_2}\)</span>:</p>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This kernel does not have an <cite>outputscale</cite> parameter. To add a scaling parameter,
decorate this kernel with a <code class="xref py py-class docutils literal notranslate"><span class="pre">gpytorch.test_kernels.ScaleKernel</span></code>.</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Non-batch: Simple option</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar_module</span> <span class="o">=</span> <span class="n">gpytorch</span><span class="o">.</span><span class="n">kernels</span><span class="o">.</span><span class="n">ScaleKernel</span><span class="p">(</span><span class="n">RandKernel</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar</span> <span class="o">=</span> <span class="n">covar_module</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Output: LazyTensor of size (10 x 10)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Batch: Simple option</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar_module</span> <span class="o">=</span> <span class="n">gpytorch</span><span class="o">.</span><span class="n">kernels</span><span class="o">.</span><span class="n">ScaleKernel</span><span class="p">(</span><span class="n">RandKernel</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar</span> <span class="o">=</span> <span class="n">covar_module</span><span class="p">(</span><span class="n">batch_x</span><span class="p">)</span>  <span class="c1"># Output: LazyTensor of size (2 x 10 x 10)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.rand_kernel.RandKernel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/rand_kernel.html#RandKernel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.rand_kernel.RandKernel.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.rand_kernel.RandKernel.covar_dist">
<span class="sig-name descname"><span class="pre">covar_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_dim_is_batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/rand_kernel.html#RandKernel.covar_dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.rand_kernel.RandKernel.covar_dist" title="Link to this definition">#</a></dt>
<dd><p>This is a helper method for computing the bit vector similarity between
all pairs of points in x1 and x2.</p>
<p>:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">x1</span></code>: First set of data.
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">x1</span></code>: Tensor <cite>n x d</cite> or <cite>b1 x … x bk x n x d</cite>
:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">x2</span></code>: Second set of data.
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">x2</span></code>: Tensor <cite>m x d</cite> or <cite>b1 x … x bk x m x d</cite>
:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">last_dim_is_batch</span></code>: Is the last dimension of the data a batch dimension or not?
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">last_dim_is_batch</span></code>: tuple, optional</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor)</span> <span class="pre">corresponding</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">distance</span> <span class="pre">matrix</span> <span class="pre">between</span> <span class="pre">`x1</span></code> and <cite>x2</cite>.
The shape depends on the kernel’s mode
* <cite>diag=False</cite>
* <cite>diag=False</cite> and <cite>last_dim_is_batch=True</cite>: (<cite>b x d x n x n</cite>)
* <cite>diag=True</cite>
* <cite>diag=True</cite> and <cite>last_dim_is_batch=True</cite>: (<cite>b x d x n</cite>)</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.rand_kernel.RandKernel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/rand_kernel.html#RandKernel.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.rand_kernel.RandKernel.forward" title="Link to this definition">#</a></dt>
<dd><p>Computes the covariance between <span class="math notranslate nohighlight">\(\mathbf x_1\)</span> and <span class="math notranslate nohighlight">\(\mathbf x_2\)</span>.
This method should be imlemented by all Kernel subclasses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> – First set of data (… x N x D).</p></li>
<li><p><strong>x2</strong> – Second set of data (… x M x D).</p></li>
<li><p><strong>diag</strong> – Should the Kernel compute the whole kernel, or just the diag?
If True, it must be the case that <cite>x1 == x2</cite>. (Default: False.)</p></li>
<li><p><strong>last_dim_is_batch</strong> – If True, treat the last dimension
of <cite>x1</cite> and <cite>x2</cite> as another batch dimension.
(Useful for additive structure over the dimensions). (Default: False.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>The kernel matrix or vector. The shape depends on the kernel’s evaluation mode:</p>
<ul class="simple">
<li><p><cite>full_covar</cite>: <cite>… x N x M</cite></p></li>
<li><p><cite>full_covar</cite> with <cite>last_dim_is_batch=True</cite>: <cite>… x K x N x M</cite></p></li>
<li><p><cite>diag</cite>: <cite>… x N</cite></p></li>
<li><p><cite>diag</cite> with <cite>last_dim_is_batch=True</cite>: <cite>… x K x N</cite></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.rand_kernel.batch_rand_sim">
<span class="sig-prename descclassname"><span class="pre">gauche.kernels.fingerprint_kernels.rand_kernel.</span></span><span class="sig-name descname"><span class="pre">batch_rand_sim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/rand_kernel.html#batch_rand_sim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.rand_kernel.batch_rand_sim" title="Link to this definition">#</a></dt>
<dd><p>Rand similarity between two batched tensors, across last 2 dimensions.
eps argument ensures numerical stability if all zero tensors are added.</p>
<p><span class="math notranslate nohighlight">\(&lt;x1, x2&gt; + d / n\)</span></p>
<p>Where &lt;.&gt; is the inner product, d is the number of common zeros and n is the dimensionality</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> – <cite>[b x n x d]</cite> Tensor where b is the batch dimension</p></li>
<li><p><strong>x2</strong> – <cite>[b x m x d]</cite> Tensor</p></li>
<li><p><strong>eps</strong> – Float for numerical stability. Default value is 1e-6</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor denoting the Rand similarity.</p>
</dd>
</dl>
</dd></dl>
<p id="module-gauche.kernels.fingerprint_kernels.rogers_tanimoto_kernel">Rogers-Tanimoto Kernel. Operates on representations including bit vectors e.g. Morgan/ECFP6 fingerprints count vectors e.g.
RDKit fragment features.</p>
<dl class="py class">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.rogers_tanimoto_kernel.RogersTanimotoKernel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gauche.kernels.fingerprint_kernels.rogers_tanimoto_kernel.</span></span><span class="sig-name descname"><span class="pre">RogersTanimotoKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/rogers_tanimoto_kernel.html#RogersTanimotoKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.rogers_tanimoto_kernel.RogersTanimotoKernel" title="Link to this definition">#</a></dt>
<dd><blockquote>
<div><p>Computes a covariance matrix based on the Rogers-Tanimoto kernel
between inputs <span class="math notranslate nohighlight">\(\mathbf{x_1}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{x_2}\)</span>:</p>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This kernel does not have an <cite>outputscale</cite> parameter. To add a scaling parameter,
decorate this kernel with a <code class="xref py py-class docutils literal notranslate"><span class="pre">gpytorch.test_kernels.ScaleKernel</span></code>.</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Non-batch: Simple option</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar_module</span> <span class="o">=</span> <span class="n">gpytorch</span><span class="o">.</span><span class="n">kernels</span><span class="o">.</span><span class="n">ScaleKernel</span><span class="p">(</span><span class="n">RogersTanimotoKernel</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar</span> <span class="o">=</span> <span class="n">covar_module</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Output: LazyTensor of size (10 x 10)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Batch: Simple option</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar_module</span> <span class="o">=</span> <span class="n">gpytorch</span><span class="o">.</span><span class="n">kernels</span><span class="o">.</span><span class="n">ScaleKernel</span><span class="p">(</span><span class="n">RogersTanimotoKernel</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar</span> <span class="o">=</span> <span class="n">covar_module</span><span class="p">(</span><span class="n">batch_x</span><span class="p">)</span>  <span class="c1"># Output: LazyTensor of size (2 x 10 x 10)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.rogers_tanimoto_kernel.RogersTanimotoKernel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/rogers_tanimoto_kernel.html#RogersTanimotoKernel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.rogers_tanimoto_kernel.RogersTanimotoKernel.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.rogers_tanimoto_kernel.RogersTanimotoKernel.covar_dist">
<span class="sig-name descname"><span class="pre">covar_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_dim_is_batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/rogers_tanimoto_kernel.html#RogersTanimotoKernel.covar_dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.rogers_tanimoto_kernel.RogersTanimotoKernel.covar_dist" title="Link to this definition">#</a></dt>
<dd><p>This is a helper method for computing the bit vector similarity between
all pairs of points in x1 and x2.</p>
<p>:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">x1</span></code>: First set of data.
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">x1</span></code>: Tensor <cite>n x d</cite> or <cite>b1 x … x bk x n x d</cite>
:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">x2</span></code>: Second set of data.
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">x2</span></code>: Tensor <cite>m x d</cite> or <cite>b1 x … x bk x m x d</cite>
:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">last_dim_is_batch</span></code>: Is the last dimension of the data a batch dimension or not?
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">last_dim_is_batch</span></code>: tuple, optional</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor)</span> <span class="pre">corresponding</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">distance</span> <span class="pre">matrix</span> <span class="pre">between</span> <span class="pre">`x1</span></code> and <cite>x2</cite>.
The shape depends on the kernel’s mode
* <cite>diag=False</cite>
* <cite>diag=False</cite> and <cite>last_dim_is_batch=True</cite>: (<cite>b x d x n x n</cite>)
* <cite>diag=True</cite>
* <cite>diag=True</cite> and <cite>last_dim_is_batch=True</cite>: (<cite>b x d x n</cite>)</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.rogers_tanimoto_kernel.RogersTanimotoKernel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/rogers_tanimoto_kernel.html#RogersTanimotoKernel.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.rogers_tanimoto_kernel.RogersTanimotoKernel.forward" title="Link to this definition">#</a></dt>
<dd><p>Computes the covariance between <span class="math notranslate nohighlight">\(\mathbf x_1\)</span> and <span class="math notranslate nohighlight">\(\mathbf x_2\)</span>.
This method should be imlemented by all Kernel subclasses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> – First set of data (… x N x D).</p></li>
<li><p><strong>x2</strong> – Second set of data (… x M x D).</p></li>
<li><p><strong>diag</strong> – Should the Kernel compute the whole kernel, or just the diag?
If True, it must be the case that <cite>x1 == x2</cite>. (Default: False.)</p></li>
<li><p><strong>last_dim_is_batch</strong> – If True, treat the last dimension
of <cite>x1</cite> and <cite>x2</cite> as another batch dimension.
(Useful for additive structure over the dimensions). (Default: False.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>The kernel matrix or vector. The shape depends on the kernel’s evaluation mode:</p>
<ul class="simple">
<li><p><cite>full_covar</cite>: <cite>… x N x M</cite></p></li>
<li><p><cite>full_covar</cite> with <cite>last_dim_is_batch=True</cite>: <cite>… x K x N x M</cite></p></li>
<li><p><cite>diag</cite>: <cite>… x N</cite></p></li>
<li><p><cite>diag</cite> with <cite>last_dim_is_batch=True</cite>: <cite>… x K x N</cite></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.rogers_tanimoto_kernel.batch_rogers_tanimoto_sim">
<span class="sig-prename descclassname"><span class="pre">gauche.kernels.fingerprint_kernels.rogers_tanimoto_kernel.</span></span><span class="sig-name descname"><span class="pre">batch_rogers_tanimoto_sim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/rogers_tanimoto_kernel.html#batch_rogers_tanimoto_sim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.rogers_tanimoto_kernel.batch_rogers_tanimoto_sim" title="Link to this definition">#</a></dt>
<dd><p>Rogers-Tanimoto similarity between two batched tensors, across last 2 dimensions.
eps argument ensures numerical stability if all zero tensors are added.</p>
<p><span class="math notranslate nohighlight">\(&lt;x1, x2&gt; + d / 2|x1| + 2|x2| - 3*&lt;x1, x2&gt; + d\)</span></p>
<p>Where || is the L1 norm and &lt;.&gt; is the inner product and d is the number of common zeros</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> – <cite>[b x n x d]</cite> Tensor where b is the batch dimension</p></li>
<li><p><strong>x2</strong> – <cite>[b x m x d]</cite> Tensor</p></li>
<li><p><strong>eps</strong> – Float for numerical stability. Default value is 1e-6</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor denoting the Otsuka similarity.</p>
</dd>
</dl>
</dd></dl>
<p id="module-gauche.kernels.fingerprint_kernels.russell_rao_kernel">Russell-Rao Kernel. Operates on representations including bit vectors e.g. Morgan/ECFP6 fingerprints count vectors e.g.
RDKit fragment features.</p>
<dl class="py class">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.russell_rao_kernel.RussellRaoKernel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gauche.kernels.fingerprint_kernels.russell_rao_kernel.</span></span><span class="sig-name descname"><span class="pre">RussellRaoKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/russell_rao_kernel.html#RussellRaoKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.russell_rao_kernel.RussellRaoKernel" title="Link to this definition">#</a></dt>
<dd><blockquote>
<div><p>Computes a covariance matrix based on the Russell and Rao kernel
between inputs <span class="math notranslate nohighlight">\(\mathbf{x_1}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{x_2}\)</span>:</p>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This kernel does not have an <cite>outputscale</cite> parameter. To add a scaling parameter,
decorate this kernel with a <code class="xref py py-class docutils literal notranslate"><span class="pre">gpytorch.test_kernels.ScaleKernel</span></code>.</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Non-batch: Simple option</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar_module</span> <span class="o">=</span> <span class="n">gpytorch</span><span class="o">.</span><span class="n">kernels</span><span class="o">.</span><span class="n">ScaleKernel</span><span class="p">(</span><span class="n">RusselRaoKernel</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar</span> <span class="o">=</span> <span class="n">covar_module</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Output: LazyTensor of size (10 x 10)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Batch: Simple option</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar_module</span> <span class="o">=</span> <span class="n">gpytorch</span><span class="o">.</span><span class="n">kernels</span><span class="o">.</span><span class="n">ScaleKernel</span><span class="p">(</span><span class="n">RusselRaoKernel</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar</span> <span class="o">=</span> <span class="n">covar_module</span><span class="p">(</span><span class="n">batch_x</span><span class="p">)</span>  <span class="c1"># Output: LazyTensor of size (2 x 10 x 10)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.russell_rao_kernel.RussellRaoKernel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/russell_rao_kernel.html#RussellRaoKernel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.russell_rao_kernel.RussellRaoKernel.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.russell_rao_kernel.RussellRaoKernel.covar_dist">
<span class="sig-name descname"><span class="pre">covar_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_dim_is_batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/russell_rao_kernel.html#RussellRaoKernel.covar_dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.russell_rao_kernel.RussellRaoKernel.covar_dist" title="Link to this definition">#</a></dt>
<dd><p>This is a helper method for computing the bit vector similarity between
all pairs of points in x1 and x2.</p>
<p>:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">x1</span></code>: First set of data.
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">x1</span></code>: Tensor <cite>n x d</cite> or <cite>b1 x … x bk x n x d</cite>
:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">x2</span></code>: Second set of data.
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">x2</span></code>: Tensor <cite>m x d</cite> or <cite>b1 x … x bk x m x d</cite>
:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">last_dim_is_batch</span></code>: Is the last dimension of the data a batch dimension or not?
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">last_dim_is_batch</span></code>: tuple, optional</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor)</span> <span class="pre">corresponding</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">distance</span> <span class="pre">matrix</span> <span class="pre">between</span> <span class="pre">`x1</span></code> and <cite>x2</cite>.
The shape depends on the kernel’s mode
* <cite>diag=False</cite>
* <cite>diag=False</cite> and <cite>last_dim_is_batch=True</cite>: (<cite>b x d x n x n</cite>)
* <cite>diag=True</cite>
* <cite>diag=True</cite> and <cite>last_dim_is_batch=True</cite>: (<cite>b x d x n</cite>)</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.russell_rao_kernel.RussellRaoKernel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/russell_rao_kernel.html#RussellRaoKernel.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.russell_rao_kernel.RussellRaoKernel.forward" title="Link to this definition">#</a></dt>
<dd><p>Computes the covariance between <span class="math notranslate nohighlight">\(\mathbf x_1\)</span> and <span class="math notranslate nohighlight">\(\mathbf x_2\)</span>.
This method should be imlemented by all Kernel subclasses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> – First set of data (… x N x D).</p></li>
<li><p><strong>x2</strong> – Second set of data (… x M x D).</p></li>
<li><p><strong>diag</strong> – Should the Kernel compute the whole kernel, or just the diag?
If True, it must be the case that <cite>x1 == x2</cite>. (Default: False.)</p></li>
<li><p><strong>last_dim_is_batch</strong> – If True, treat the last dimension
of <cite>x1</cite> and <cite>x2</cite> as another batch dimension.
(Useful for additive structure over the dimensions). (Default: False.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>The kernel matrix or vector. The shape depends on the kernel’s evaluation mode:</p>
<ul class="simple">
<li><p><cite>full_covar</cite>: <cite>… x N x M</cite></p></li>
<li><p><cite>full_covar</cite> with <cite>last_dim_is_batch=True</cite>: <cite>… x K x N x M</cite></p></li>
<li><p><cite>diag</cite>: <cite>… x N</cite></p></li>
<li><p><cite>diag</cite> with <cite>last_dim_is_batch=True</cite>: <cite>… x K x N</cite></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.russell_rao_kernel.batch_russell_rao_sim">
<span class="sig-prename descclassname"><span class="pre">gauche.kernels.fingerprint_kernels.russell_rao_kernel.</span></span><span class="sig-name descname"><span class="pre">batch_russell_rao_sim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/russell_rao_kernel.html#batch_russell_rao_sim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.russell_rao_kernel.batch_russell_rao_sim" title="Link to this definition">#</a></dt>
<dd><p>Russell-Rao similarity between two batched tensors, across last 2 dimensions.
eps argument ensures numerical stability if all zero tensors are added.</p>
<p><span class="math notranslate nohighlight">\(&lt;x1, x2&gt; / n\)</span></p>
<p>Where &lt;.&gt; is the inner product and n is the dimension of the vectors x1/x2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> – <cite>[b x n x d]</cite> Tensor where b is the batch dimension</p></li>
<li><p><strong>x2</strong> – <cite>[b x m x d]</cite> Tensor</p></li>
<li><p><strong>eps</strong> – Float for numerical stability. Default value is 1e-6</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor denoting the Russell and Rao similarity.</p>
</dd>
</dl>
</dd></dl>
<p id="module-gauche.kernels.fingerprint_kernels.sogenfrei_kernel">Sogenfrei Kernel. Operates on representations including bit vectors e.g. Morgan/ECFP6 fingerprints count vectors e.g.
RDKit fragment features.</p>
<dl class="py class">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.sogenfrei_kernel.SogenfreiKernel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gauche.kernels.fingerprint_kernels.sogenfrei_kernel.</span></span><span class="sig-name descname"><span class="pre">SogenfreiKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/sogenfrei_kernel.html#SogenfreiKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.sogenfrei_kernel.SogenfreiKernel" title="Link to this definition">#</a></dt>
<dd><blockquote>
<div><p>Computes a covariance matrix based on the Sogenfrei kernel
between inputs <span class="math notranslate nohighlight">\(\mathbf{x_1}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{x_2}\)</span>:</p>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This kernel does not have an <cite>outputscale</cite> parameter. To add a scaling parameter,
decorate this kernel with a <code class="xref py py-class docutils literal notranslate"><span class="pre">gpytorch.test_kernels.ScaleKernel</span></code>.</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Non-batch: Simple option</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar_module</span> <span class="o">=</span> <span class="n">gpytorch</span><span class="o">.</span><span class="n">kernels</span><span class="o">.</span><span class="n">ScaleKernel</span><span class="p">(</span><span class="n">SogenfreiKernel</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar</span> <span class="o">=</span> <span class="n">covar_module</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Output: LazyTensor of size (10 x 10)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Batch: Simple option</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar_module</span> <span class="o">=</span> <span class="n">gpytorch</span><span class="o">.</span><span class="n">kernels</span><span class="o">.</span><span class="n">ScaleKernel</span><span class="p">(</span><span class="n">SogenfreiKernel</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar</span> <span class="o">=</span> <span class="n">covar_module</span><span class="p">(</span><span class="n">batch_x</span><span class="p">)</span>  <span class="c1"># Output: LazyTensor of size (2 x 10 x 10)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.sogenfrei_kernel.SogenfreiKernel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/sogenfrei_kernel.html#SogenfreiKernel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.sogenfrei_kernel.SogenfreiKernel.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.sogenfrei_kernel.SogenfreiKernel.covar_dist">
<span class="sig-name descname"><span class="pre">covar_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_dim_is_batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/sogenfrei_kernel.html#SogenfreiKernel.covar_dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.sogenfrei_kernel.SogenfreiKernel.covar_dist" title="Link to this definition">#</a></dt>
<dd><p>This is a helper method for computing the bit vector similarity between
all pairs of points in x1 and x2.</p>
<p>:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">x1</span></code>: First set of data.
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">x1</span></code>: Tensor <cite>n x d</cite> or <cite>b1 x … x bk x n x d</cite>
:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">x2</span></code>: Second set of data.
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">x2</span></code>: Tensor <cite>m x d</cite> or <cite>b1 x … x bk x m x d</cite>
:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">last_dim_is_batch</span></code>: Is the last dimension of the data a batch dimension or not?
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">last_dim_is_batch</span></code>: tuple, optional</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor)</span> <span class="pre">corresponding</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">distance</span> <span class="pre">matrix</span> <span class="pre">between</span> <span class="pre">`x1</span></code> and <cite>x2</cite>.
The shape depends on the kernel’s mode
* <cite>diag=False</cite>
* <cite>diag=False</cite> and <cite>last_dim_is_batch=True</cite>: (<cite>b x d x n x n</cite>)
* <cite>diag=True</cite>
* <cite>diag=True</cite> and <cite>last_dim_is_batch=True</cite>: (<cite>b x d x n</cite>)</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.sogenfrei_kernel.SogenfreiKernel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/sogenfrei_kernel.html#SogenfreiKernel.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.sogenfrei_kernel.SogenfreiKernel.forward" title="Link to this definition">#</a></dt>
<dd><p>Computes the covariance between <span class="math notranslate nohighlight">\(\mathbf x_1\)</span> and <span class="math notranslate nohighlight">\(\mathbf x_2\)</span>.
This method should be imlemented by all Kernel subclasses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> – First set of data (… x N x D).</p></li>
<li><p><strong>x2</strong> – Second set of data (… x M x D).</p></li>
<li><p><strong>diag</strong> – Should the Kernel compute the whole kernel, or just the diag?
If True, it must be the case that <cite>x1 == x2</cite>. (Default: False.)</p></li>
<li><p><strong>last_dim_is_batch</strong> – If True, treat the last dimension
of <cite>x1</cite> and <cite>x2</cite> as another batch dimension.
(Useful for additive structure over the dimensions). (Default: False.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>The kernel matrix or vector. The shape depends on the kernel’s evaluation mode:</p>
<ul class="simple">
<li><p><cite>full_covar</cite>: <cite>… x N x M</cite></p></li>
<li><p><cite>full_covar</cite> with <cite>last_dim_is_batch=True</cite>: <cite>… x K x N x M</cite></p></li>
<li><p><cite>diag</cite>: <cite>… x N</cite></p></li>
<li><p><cite>diag</cite> with <cite>last_dim_is_batch=True</cite>: <cite>… x K x N</cite></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.sogenfrei_kernel.batch_sogenfrei_sim">
<span class="sig-prename descclassname"><span class="pre">gauche.kernels.fingerprint_kernels.sogenfrei_kernel.</span></span><span class="sig-name descname"><span class="pre">batch_sogenfrei_sim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/sogenfrei_kernel.html#batch_sogenfrei_sim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.sogenfrei_kernel.batch_sogenfrei_sim" title="Link to this definition">#</a></dt>
<dd><p>Sogenfrei similarity between two batched tensors, across last 2 dimensions.
eps argument ensures numerical stability if all zero tensors are added.</p>
<p><span class="math notranslate nohighlight">\(&lt;x1, x2&gt;**2 / (|x1| + |x2|)\)</span></p>
<p>Where &lt;.&gt; is the inner product and || is the L1 norm</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> – <cite>[b x n x d]</cite> Tensor where b is the batch dimension</p></li>
<li><p><strong>x2</strong> – <cite>[b x m x d]</cite> Tensor</p></li>
<li><p><strong>eps</strong> – Float for numerical stability. Default value is 1e-6</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor denoting the Sogenfrei similarity.</p>
</dd>
</dl>
</dd></dl>
<p id="module-gauche.kernels.fingerprint_kernels.sokal_sneath_kernel">Sokal-Sneath Kernel. Operates on representations including bit vectors e.g. Morgan/ECFP6 fingerprints count vectors e.g.
RDKit fragment features.</p>
<dl class="py class">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.sokal_sneath_kernel.SokalSneathKernel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gauche.kernels.fingerprint_kernels.sokal_sneath_kernel.</span></span><span class="sig-name descname"><span class="pre">SokalSneathKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/sokal_sneath_kernel.html#SokalSneathKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.sokal_sneath_kernel.SokalSneathKernel" title="Link to this definition">#</a></dt>
<dd><blockquote>
<div><p>Computes a covariance matrix based on the Sokal-Sneath kernel
between inputs <span class="math notranslate nohighlight">\(\mathbf{x_1}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{x_2}\)</span>:</p>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This kernel does not have an <cite>outputscale</cite> parameter. To add a scaling parameter,
decorate this kernel with a <code class="xref py py-class docutils literal notranslate"><span class="pre">gpytorch.test_kernels.ScaleKernel</span></code>.</p>
<dl>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Non-batch: Simple option</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar_module</span> <span class="o">=</span> <span class="n">gpytorch</span><span class="o">.</span><span class="n">kernels</span><span class="o">.</span><span class="n">ScaleKernel</span><span class="p">(</span><span class="n">SokalSneathKernel</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar</span> <span class="o">=</span> <span class="n">covar_module</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># Output: LazyTensor of size (10 x 10)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Batch: Simple option</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar_module</span> <span class="o">=</span> <span class="n">gpytorch</span><span class="o">.</span><span class="n">kernels</span><span class="o">.</span><span class="n">ScaleKernel</span><span class="p">(</span><span class="n">SokalSneathKernel</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">covar</span> <span class="o">=</span> <span class="n">covar_module</span><span class="p">(</span><span class="n">batch_x</span><span class="p">)</span>  <span class="c1"># Output: LazyTensor of size (2 x 10 x 10)</span>
</pre></div>
</div>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.sokal_sneath_kernel.SokalSneathKernel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/sokal_sneath_kernel.html#SokalSneathKernel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.sokal_sneath_kernel.SokalSneathKernel.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.sokal_sneath_kernel.SokalSneathKernel.covar_dist">
<span class="sig-name descname"><span class="pre">covar_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_dim_is_batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/sokal_sneath_kernel.html#SokalSneathKernel.covar_dist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.sokal_sneath_kernel.SokalSneathKernel.covar_dist" title="Link to this definition">#</a></dt>
<dd><p>This is a helper method for computing the bit vector similarity between
all pairs of points in x1 and x2.</p>
<p>:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">x1</span></code>: First set of data.
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">x1</span></code>: Tensor <cite>n x d</cite> or <cite>b1 x … x bk x n x d</cite>
:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">x2</span></code>: Second set of data.
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">x2</span></code>: Tensor <cite>m x d</cite> or <cite>b1 x … x bk x m x d</cite>
:param <code class="xref py py-attr docutils literal notranslate"><span class="pre">last_dim_is_batch</span></code>: Is the last dimension of the data a batch dimension or not?
:type <code class="xref py py-attr docutils literal notranslate"><span class="pre">last_dim_is_batch</span></code>: tuple, optional</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(<code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor)</span> <span class="pre">corresponding</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">distance</span> <span class="pre">matrix</span> <span class="pre">between</span> <span class="pre">`x1</span></code> and <cite>x2</cite>.
The shape depends on the kernel’s mode
* <cite>diag=False</cite>
* <cite>diag=False</cite> and <cite>last_dim_is_batch=True</cite>: (<cite>b x d x n x n</cite>)
* <cite>diag=True</cite>
* <cite>diag=True</cite> and <cite>last_dim_is_batch=True</cite>: (<cite>b x d x n</cite>)</p>
</dd>
</dl>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.sokal_sneath_kernel.SokalSneathKernel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/sokal_sneath_kernel.html#SokalSneathKernel.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.sokal_sneath_kernel.SokalSneathKernel.forward" title="Link to this definition">#</a></dt>
<dd><p>Computes the covariance between <span class="math notranslate nohighlight">\(\mathbf x_1\)</span> and <span class="math notranslate nohighlight">\(\mathbf x_2\)</span>.
This method should be imlemented by all Kernel subclasses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> – First set of data (… x N x D).</p></li>
<li><p><strong>x2</strong> – Second set of data (… x M x D).</p></li>
<li><p><strong>diag</strong> – Should the Kernel compute the whole kernel, or just the diag?
If True, it must be the case that <cite>x1 == x2</cite>. (Default: False.)</p></li>
<li><p><strong>last_dim_is_batch</strong> – If True, treat the last dimension
of <cite>x1</cite> and <cite>x2</cite> as another batch dimension.
(Useful for additive structure over the dimensions). (Default: False.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>The kernel matrix or vector. The shape depends on the kernel’s evaluation mode:</p>
<ul class="simple">
<li><p><cite>full_covar</cite>: <cite>… x N x M</cite></p></li>
<li><p><cite>full_covar</cite> with <cite>last_dim_is_batch=True</cite>: <cite>… x K x N x M</cite></p></li>
<li><p><cite>diag</cite>: <cite>… x N</cite></p></li>
<li><p><cite>diag</cite> with <cite>last_dim_is_batch=True</cite>: <cite>… x K x N</cite></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="gauche.kernels.fingerprint_kernels.sokal_sneath_kernel.batch_sokal_sneath_sim">
<span class="sig-prename descclassname"><span class="pre">gauche.kernels.fingerprint_kernels.sokal_sneath_kernel.</span></span><span class="sig-name descname"><span class="pre">batch_sokal_sneath_sim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></span><a class="reference internal" href="../_modules/gauche/kernels/fingerprint_kernels/sokal_sneath_kernel.html#batch_sokal_sneath_sim"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.fingerprint_kernels.sokal_sneath_kernel.batch_sokal_sneath_sim" title="Link to this definition">#</a></dt>
<dd><p>Sokal-Sneath similarity between two batched tensors, across last 2 dimensions.
eps argument ensures numerical stability if all zero tensors are added.</p>
<p><span class="math notranslate nohighlight">\(&lt;x1, x2&gt; / 2|x1| + 2|x2| - 3*&lt;x1, x2&gt;\)</span></p>
<p>Where &lt;.&gt; is the inner product and || is the L1 norm</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> – <cite>[b x n x d]</cite> Tensor where b is the batch dimension</p></li>
<li><p><strong>x2</strong> – <cite>[b x m x d]</cite> Tensor</p></li>
<li><p><strong>eps</strong> – Float for numerical stability. Default value is 1e-6</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tensor denoting the Sokal-Sneath similarity.</p>
</dd>
</dl>
</dd></dl>
</section>
<section id="module-gauche.kernels.graph_kernels">
<span id="graph-kernels"></span><h2>Graph Kernels<a class="headerlink" href="#module-gauche.kernels.graph_kernels" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="gauche.kernels.graph_kernels.EdgeHistogramKernel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gauche.kernels.graph_kernels.</span></span><span class="sig-name descname"><span class="pre">EdgeHistogramKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edge_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">torch.float32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/graph_kernels/grakel_kernels.html#EdgeHistogramKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.graph_kernels.EdgeHistogramKernel" title="Link to this definition">#</a></dt>
<dd><p>A GraKel wrapper for the edge histogram kernel.
This kernel requires edge labels to be specified.</p>
<p>See <a class="reference external" href="https://ysig.github.io/GraKeL/0.1a8/kernels/edge_histogram.html">https://ysig.github.io/GraKeL/0.1a8/kernels/edge_histogram.html</a>
for more details.</p>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.graph_kernels.EdgeHistogramKernel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edge_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">torch.float32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/graph_kernels/grakel_kernels.html#EdgeHistogramKernel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.graph_kernels.EdgeHistogramKernel.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="gauche.kernels.graph_kernels.GraphletSamplingKernel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gauche.kernels.graph_kernels.</span></span><span class="sig-name descname"><span class="pre">GraphletSamplingKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">torch.float32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/graph_kernels/grakel_kernels.html#GraphletSamplingKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.graph_kernels.GraphletSamplingKernel" title="Link to this definition">#</a></dt>
<dd><p>A GraKel wrapper for the graphlet sampling kernel.
This kernel only works on unlabelled graphs.</p>
<p>See <a class="reference external" href="https://ysig.github.io/GraKeL/0.1a8/kernels/graphlet_sampling.html">https://ysig.github.io/GraKeL/0.1a8/kernels/graphlet_sampling.html</a>
for more details.</p>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.graph_kernels.GraphletSamplingKernel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">torch.float32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/graph_kernels/grakel_kernels.html#GraphletSamplingKernel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.graph_kernels.GraphletSamplingKernel.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="gauche.kernels.graph_kernels.NeighborhoodHashKernel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gauche.kernels.graph_kernels.</span></span><span class="sig-name descname"><span class="pre">NeighborhoodHashKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node_label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">torch.float32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/graph_kernels/grakel_kernels.html#NeighborhoodHashKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.graph_kernels.NeighborhoodHashKernel" title="Link to this definition">#</a></dt>
<dd><p>A GraKel wrapper for the neighborhood hash kernel.
This kernel requires node labels to be specified.</p>
<p>See <a class="reference external" href="https://ysig.github.io/GraKeL/0.1a8/kernels/neighborhood_hash.html">https://ysig.github.io/GraKeL/0.1a8/kernels/neighborhood_hash.html</a>
for more details.</p>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.graph_kernels.NeighborhoodHashKernel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node_label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">torch.float32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/graph_kernels/grakel_kernels.html#NeighborhoodHashKernel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.graph_kernels.NeighborhoodHashKernel.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="gauche.kernels.graph_kernels.RandomWalkKernel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gauche.kernels.graph_kernels.</span></span><span class="sig-name descname"><span class="pre">RandomWalkKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">torch.float32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/graph_kernels/grakel_kernels.html#RandomWalkKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.graph_kernels.RandomWalkKernel" title="Link to this definition">#</a></dt>
<dd><p>A GraKel wrapper for the random walk kernel.
This kernel only works on unlabelled graphs.
See RandomWalkLabeledKernel for labelled graphs.</p>
<p>See <a class="reference external" href="https://ysig.github.io/GraKeL/0.1a8/kernels/random_walk.html">https://ysig.github.io/GraKeL/0.1a8/kernels/random_walk.html</a>
for more details.</p>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.graph_kernels.RandomWalkKernel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">torch.float32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/graph_kernels/grakel_kernels.html#RandomWalkKernel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.graph_kernels.RandomWalkKernel.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="gauche.kernels.graph_kernels.RandomWalkLabeledKernel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gauche.kernels.graph_kernels.</span></span><span class="sig-name descname"><span class="pre">RandomWalkLabeledKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node_label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">torch.float32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/graph_kernels/grakel_kernels.html#RandomWalkLabeledKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.graph_kernels.RandomWalkLabeledKernel" title="Link to this definition">#</a></dt>
<dd><p>A GraKel wrapper for the random walk kernel.
This kernel requires node labels to be specified.</p>
<p>See <a class="reference external" href="https://ysig.github.io/GraKeL/0.1a8/kernels/random_walk.html">https://ysig.github.io/GraKeL/0.1a8/kernels/random_walk.html</a>
for more details.</p>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.graph_kernels.RandomWalkLabeledKernel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node_label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">torch.float32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/graph_kernels/grakel_kernels.html#RandomWalkLabeledKernel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.graph_kernels.RandomWalkLabeledKernel.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="gauche.kernels.graph_kernels.ShortestPathKernel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gauche.kernels.graph_kernels.</span></span><span class="sig-name descname"><span class="pre">ShortestPathKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">torch.float32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/graph_kernels/grakel_kernels.html#ShortestPathKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.graph_kernels.ShortestPathKernel" title="Link to this definition">#</a></dt>
<dd><p>A GraKel wrapper for the shortest path kernel.
This kernel only works on unlabelled graphs.
See ShortestPathLabeledKernel for labelled graphs.</p>
<p>See <a class="reference external" href="https://ysig.github.io/GraKeL/0.1a8/kernels/shortest_path.html">https://ysig.github.io/GraKeL/0.1a8/kernels/shortest_path.html</a>
for more details.</p>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.graph_kernels.ShortestPathKernel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">torch.float32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/graph_kernels/grakel_kernels.html#ShortestPathKernel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.graph_kernels.ShortestPathKernel.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="gauche.kernels.graph_kernels.ShortestPathLabeledKernel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gauche.kernels.graph_kernels.</span></span><span class="sig-name descname"><span class="pre">ShortestPathLabeledKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node_label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">torch.float32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/graph_kernels/grakel_kernels.html#ShortestPathLabeledKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.graph_kernels.ShortestPathLabeledKernel" title="Link to this definition">#</a></dt>
<dd><p>A GraKel wrapper for the shortest path kernel.
This kernel requires node labels to be specified.</p>
<p>See <a class="reference external" href="https://ysig.github.io/GraKeL/0.1a8/kernels/shortest_path.html">https://ysig.github.io/GraKeL/0.1a8/kernels/shortest_path.html</a>
for more details.</p>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.graph_kernels.ShortestPathLabeledKernel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node_label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">torch.float32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/graph_kernels/grakel_kernels.html#ShortestPathLabeledKernel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.graph_kernels.ShortestPathLabeledKernel.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="gauche.kernels.graph_kernels.VertexHistogramKernel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gauche.kernels.graph_kernels.</span></span><span class="sig-name descname"><span class="pre">VertexHistogramKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node_label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">torch.float32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/graph_kernels/grakel_kernels.html#VertexHistogramKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.graph_kernels.VertexHistogramKernel" title="Link to this definition">#</a></dt>
<dd><p>A GraKel wrapper for the vertex histogram kernel.
This kernel requires node labels to be specified.</p>
<p>See <a class="reference external" href="https://ysig.github.io/GraKeL/0.1a8/kernels/vertex_histogram.html">https://ysig.github.io/GraKeL/0.1a8/kernels/vertex_histogram.html</a>
for more details.</p>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.graph_kernels.VertexHistogramKernel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node_label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">torch.float32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/graph_kernels/grakel_kernels.html#VertexHistogramKernel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.graph_kernels.VertexHistogramKernel.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="gauche.kernels.graph_kernels.WeisfeilerLehmanKernel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gauche.kernels.graph_kernels.</span></span><span class="sig-name descname"><span class="pre">WeisfeilerLehmanKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node_label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">torch.float32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/graph_kernels/grakel_kernels.html#WeisfeilerLehmanKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.graph_kernels.WeisfeilerLehmanKernel" title="Link to this definition">#</a></dt>
<dd><p>A GraKel wrapper for the Weisfeiler-Lehman kernel.
This kernel needs node labels to be specified and
can optionally use edge labels for the base kernel.</p>
<p>See <a class="reference external" href="https://ysig.github.io/GraKeL/0.1a8/kernels/weisfeiler_lehman.html">https://ysig.github.io/GraKeL/0.1a8/kernels/weisfeiler_lehman.html</a>
for more details.</p>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.graph_kernels.WeisfeilerLehmanKernel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node_label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">torch.float32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/graph_kernels/grakel_kernels.html#WeisfeilerLehmanKernel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.graph_kernels.WeisfeilerLehmanKernel.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>
</dd></dl>
</section>
<section id="module-gauche.kernels.string_kernels">
<span id="string-kernels"></span><h2>String Kernels<a class="headerlink" href="#module-gauche.kernels.string_kernels" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="gauche.kernels.string_kernels.SubsequenceStringKernel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gauche.kernels.string_kernels.</span></span><span class="sig-name descname"><span class="pre">SubsequenceStringKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphabet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxlen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">80</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_gap_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_match_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_order_coefs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1.0,</span> <span class="pre">0.5,</span> <span class="pre">0.25,</span> <span class="pre">0.125,</span> <span class="pre">0.0625]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/string_kernels/sskkernel.html#SubsequenceStringKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.string_kernels.SubsequenceStringKernel" title="Link to this definition">#</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.string_kernels.SubsequenceStringKernel.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alphabet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxlen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">80</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_gap_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_match_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_order_coefs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[1.0,</span> <span class="pre">0.5,</span> <span class="pre">0.25,</span> <span class="pre">0.125,</span> <span class="pre">0.0625]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/string_kernels/sskkernel.html#SubsequenceStringKernel.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.string_kernels.SubsequenceStringKernel.__init__" title="Link to this definition">#</a></dt>
<dd><p>Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="gauche.kernels.string_kernels.SubsequenceStringKernel.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">X2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://pytorch.org/docs/master/tensors.html#torch.Tensor" title="(in PyTorch vmaster (2.1.0a0+gitbe0b12e ))"><span class="pre">Tensor</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/gauche/kernels/string_kernels/sskkernel.html#SubsequenceStringKernel.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gauche.kernels.string_kernels.SubsequenceStringKernel.forward" title="Link to this definition">#</a></dt>
<dd><p>Computes the covariance between <span class="math notranslate nohighlight">\(\mathbf x_1\)</span> and <span class="math notranslate nohighlight">\(\mathbf x_2\)</span>.
This method should be imlemented by all Kernel subclasses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> – First set of data (… x N x D).</p></li>
<li><p><strong>x2</strong> – Second set of data (… x M x D).</p></li>
<li><p><strong>diag</strong> – Should the Kernel compute the whole kernel, or just the diag?
If True, it must be the case that <cite>x1 == x2</cite>. (Default: False.)</p></li>
<li><p><strong>last_dim_is_batch</strong> – If True, treat the last dimension
of <cite>x1</cite> and <cite>x2</cite> as another batch dimension.
(Useful for additive structure over the dimensions). (Default: False.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>The kernel matrix or vector. The shape depends on the kernel’s evaluation mode:</p>
<ul class="simple">
<li><p><cite>full_covar</cite>: <cite>… x N x M</cite></p></li>
<li><p><cite>full_covar</cite> with <cite>last_dim_is_batch=True</cite>: <cite>… x K x N x M</cite></p></li>
<li><p><cite>diag</cite>: <cite>… x N</cite></p></li>
<li><p><cite>diag</cite> with <cite>last_dim_is_batch=True</cite>: <cite>… x K x N</cite></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>
</dd></dl>
</section>
</section>
</article>
</div>
<footer>
<div class="related-pages">
<a class="next-page" href="representations.html">
<div class="page-info">
<div class="context">
<span>Next</span>
</div>
<div class="title">gauche.representations</div>
</div>
<svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
</a>
<a class="prev-page" href="../notebooks/bayesian_gnn_on_molecules.html">
<svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
<div class="page-info">
<div class="context">
<span>Previous</span>
</div>
<div class="title">Bayesian GNNs for Molecular Property Prediction</div>
</div>
</a>
</div>
<div class="bottom-of-page">
<div class="left-details">
<div class="copyright">
                Copyright © 2022, Ryan Rhys-Griffiths
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
</div>
<div class="right-details">
</div>
</div>
</footer>
</div>
<aside class="toc-drawer">
<div class="toc-sticky toc-scroll">
<div class="toc-title-container">
<span class="toc-title">
            On this page
          </span>
</div>
<div class="toc-tree-container">
<div class="toc-tree">
<ul>
<li><a class="reference internal" href="#">gauche.kernels</a><ul>
<li><a class="reference internal" href="#module-gauche.kernels.fingerprint_kernels.tanimoto_kernel">Fingerprint Kernels</a><ul>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.tanimoto_kernel.TanimotoKernel"><code class="docutils literal notranslate"><span class="pre">TanimotoKernel</span></code></a><ul>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.tanimoto_kernel.TanimotoKernel.__init__"><code class="docutils literal notranslate"><span class="pre">TanimotoKernel.__init__()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.tanimoto_kernel.TanimotoKernel.covar_dist"><code class="docutils literal notranslate"><span class="pre">TanimotoKernel.covar_dist()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.tanimoto_kernel.TanimotoKernel.forward"><code class="docutils literal notranslate"><span class="pre">TanimotoKernel.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.tanimoto_kernel.batch_tanimoto_sim"><code class="docutils literal notranslate"><span class="pre">batch_tanimoto_sim()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.braun_blanquet_kernel.BraunBlanquetKernel"><code class="docutils literal notranslate"><span class="pre">BraunBlanquetKernel</span></code></a><ul>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.braun_blanquet_kernel.BraunBlanquetKernel.__init__"><code class="docutils literal notranslate"><span class="pre">BraunBlanquetKernel.__init__()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.braun_blanquet_kernel.BraunBlanquetKernel.covar_dist"><code class="docutils literal notranslate"><span class="pre">BraunBlanquetKernel.covar_dist()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.braun_blanquet_kernel.BraunBlanquetKernel.forward"><code class="docutils literal notranslate"><span class="pre">BraunBlanquetKernel.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.braun_blanquet_kernel.batch_braun_blanquet_sim"><code class="docutils literal notranslate"><span class="pre">batch_braun_blanquet_sim()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.dice_kernel.DiceKernel"><code class="docutils literal notranslate"><span class="pre">DiceKernel</span></code></a><ul>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.dice_kernel.DiceKernel.__init__"><code class="docutils literal notranslate"><span class="pre">DiceKernel.__init__()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.dice_kernel.DiceKernel.covar_dist"><code class="docutils literal notranslate"><span class="pre">DiceKernel.covar_dist()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.dice_kernel.DiceKernel.forward"><code class="docutils literal notranslate"><span class="pre">DiceKernel.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.dice_kernel.batch_dice_sim"><code class="docutils literal notranslate"><span class="pre">batch_dice_sim()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.faith_kernel.FaithKernel"><code class="docutils literal notranslate"><span class="pre">FaithKernel</span></code></a><ul>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.faith_kernel.FaithKernel.__init__"><code class="docutils literal notranslate"><span class="pre">FaithKernel.__init__()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.faith_kernel.FaithKernel.covar_dist"><code class="docutils literal notranslate"><span class="pre">FaithKernel.covar_dist()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.faith_kernel.FaithKernel.forward"><code class="docutils literal notranslate"><span class="pre">FaithKernel.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.faith_kernel.batch_faith_sim"><code class="docutils literal notranslate"><span class="pre">batch_faith_sim()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.forbes_kernel.ForbesKernel"><code class="docutils literal notranslate"><span class="pre">ForbesKernel</span></code></a><ul>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.forbes_kernel.ForbesKernel.__init__"><code class="docutils literal notranslate"><span class="pre">ForbesKernel.__init__()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.forbes_kernel.ForbesKernel.covar_dist"><code class="docutils literal notranslate"><span class="pre">ForbesKernel.covar_dist()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.forbes_kernel.ForbesKernel.forward"><code class="docutils literal notranslate"><span class="pre">ForbesKernel.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.forbes_kernel.batch_forbes_sim"><code class="docutils literal notranslate"><span class="pre">batch_forbes_sim()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.inner_product_kernel.InnerProductKernel"><code class="docutils literal notranslate"><span class="pre">InnerProductKernel</span></code></a><ul>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.inner_product_kernel.InnerProductKernel.__init__"><code class="docutils literal notranslate"><span class="pre">InnerProductKernel.__init__()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.inner_product_kernel.InnerProductKernel.covar_dist"><code class="docutils literal notranslate"><span class="pre">InnerProductKernel.covar_dist()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.inner_product_kernel.InnerProductKernel.forward"><code class="docutils literal notranslate"><span class="pre">InnerProductKernel.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.inner_product_kernel.batch_inner_product_sim"><code class="docutils literal notranslate"><span class="pre">batch_inner_product_sim()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.intersection_kernel.IntersectionKernel"><code class="docutils literal notranslate"><span class="pre">IntersectionKernel</span></code></a><ul>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.intersection_kernel.IntersectionKernel.__init__"><code class="docutils literal notranslate"><span class="pre">IntersectionKernel.__init__()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.intersection_kernel.IntersectionKernel.covar_dist"><code class="docutils literal notranslate"><span class="pre">IntersectionKernel.covar_dist()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.intersection_kernel.IntersectionKernel.forward"><code class="docutils literal notranslate"><span class="pre">IntersectionKernel.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.intersection_kernel.batch_intersection_sim"><code class="docutils literal notranslate"><span class="pre">batch_intersection_sim()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.minmax_kernel.MinMaxKernel"><code class="docutils literal notranslate"><span class="pre">MinMaxKernel</span></code></a><ul>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.minmax_kernel.MinMaxKernel.__init__"><code class="docutils literal notranslate"><span class="pre">MinMaxKernel.__init__()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.minmax_kernel.MinMaxKernel.covar_dist"><code class="docutils literal notranslate"><span class="pre">MinMaxKernel.covar_dist()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.minmax_kernel.MinMaxKernel.forward"><code class="docutils literal notranslate"><span class="pre">MinMaxKernel.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.minmax_kernel.batch_minmax_sim"><code class="docutils literal notranslate"><span class="pre">batch_minmax_sim()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.otsuka_kernel.OtsukaKernel"><code class="docutils literal notranslate"><span class="pre">OtsukaKernel</span></code></a><ul>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.otsuka_kernel.OtsukaKernel.__init__"><code class="docutils literal notranslate"><span class="pre">OtsukaKernel.__init__()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.otsuka_kernel.OtsukaKernel.covar_dist"><code class="docutils literal notranslate"><span class="pre">OtsukaKernel.covar_dist()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.otsuka_kernel.OtsukaKernel.forward"><code class="docutils literal notranslate"><span class="pre">OtsukaKernel.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.otsuka_kernel.batch_otsuka_sim"><code class="docutils literal notranslate"><span class="pre">batch_otsuka_sim()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.rand_kernel.RandKernel"><code class="docutils literal notranslate"><span class="pre">RandKernel</span></code></a><ul>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.rand_kernel.RandKernel.__init__"><code class="docutils literal notranslate"><span class="pre">RandKernel.__init__()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.rand_kernel.RandKernel.covar_dist"><code class="docutils literal notranslate"><span class="pre">RandKernel.covar_dist()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.rand_kernel.RandKernel.forward"><code class="docutils literal notranslate"><span class="pre">RandKernel.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.rand_kernel.batch_rand_sim"><code class="docutils literal notranslate"><span class="pre">batch_rand_sim()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.rogers_tanimoto_kernel.RogersTanimotoKernel"><code class="docutils literal notranslate"><span class="pre">RogersTanimotoKernel</span></code></a><ul>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.rogers_tanimoto_kernel.RogersTanimotoKernel.__init__"><code class="docutils literal notranslate"><span class="pre">RogersTanimotoKernel.__init__()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.rogers_tanimoto_kernel.RogersTanimotoKernel.covar_dist"><code class="docutils literal notranslate"><span class="pre">RogersTanimotoKernel.covar_dist()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.rogers_tanimoto_kernel.RogersTanimotoKernel.forward"><code class="docutils literal notranslate"><span class="pre">RogersTanimotoKernel.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.rogers_tanimoto_kernel.batch_rogers_tanimoto_sim"><code class="docutils literal notranslate"><span class="pre">batch_rogers_tanimoto_sim()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.russell_rao_kernel.RussellRaoKernel"><code class="docutils literal notranslate"><span class="pre">RussellRaoKernel</span></code></a><ul>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.russell_rao_kernel.RussellRaoKernel.__init__"><code class="docutils literal notranslate"><span class="pre">RussellRaoKernel.__init__()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.russell_rao_kernel.RussellRaoKernel.covar_dist"><code class="docutils literal notranslate"><span class="pre">RussellRaoKernel.covar_dist()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.russell_rao_kernel.RussellRaoKernel.forward"><code class="docutils literal notranslate"><span class="pre">RussellRaoKernel.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.russell_rao_kernel.batch_russell_rao_sim"><code class="docutils literal notranslate"><span class="pre">batch_russell_rao_sim()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.sogenfrei_kernel.SogenfreiKernel"><code class="docutils literal notranslate"><span class="pre">SogenfreiKernel</span></code></a><ul>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.sogenfrei_kernel.SogenfreiKernel.__init__"><code class="docutils literal notranslate"><span class="pre">SogenfreiKernel.__init__()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.sogenfrei_kernel.SogenfreiKernel.covar_dist"><code class="docutils literal notranslate"><span class="pre">SogenfreiKernel.covar_dist()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.sogenfrei_kernel.SogenfreiKernel.forward"><code class="docutils literal notranslate"><span class="pre">SogenfreiKernel.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.sogenfrei_kernel.batch_sogenfrei_sim"><code class="docutils literal notranslate"><span class="pre">batch_sogenfrei_sim()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.sokal_sneath_kernel.SokalSneathKernel"><code class="docutils literal notranslate"><span class="pre">SokalSneathKernel</span></code></a><ul>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.sokal_sneath_kernel.SokalSneathKernel.__init__"><code class="docutils literal notranslate"><span class="pre">SokalSneathKernel.__init__()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.sokal_sneath_kernel.SokalSneathKernel.covar_dist"><code class="docutils literal notranslate"><span class="pre">SokalSneathKernel.covar_dist()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.sokal_sneath_kernel.SokalSneathKernel.forward"><code class="docutils literal notranslate"><span class="pre">SokalSneathKernel.forward()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#gauche.kernels.fingerprint_kernels.sokal_sneath_kernel.batch_sokal_sneath_sim"><code class="docutils literal notranslate"><span class="pre">batch_sokal_sneath_sim()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-gauche.kernels.graph_kernels">Graph Kernels</a><ul>
<li><a class="reference internal" href="#gauche.kernels.graph_kernels.EdgeHistogramKernel"><code class="docutils literal notranslate"><span class="pre">EdgeHistogramKernel</span></code></a><ul>
<li><a class="reference internal" href="#gauche.kernels.graph_kernels.EdgeHistogramKernel.__init__"><code class="docutils literal notranslate"><span class="pre">EdgeHistogramKernel.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#gauche.kernels.graph_kernels.GraphletSamplingKernel"><code class="docutils literal notranslate"><span class="pre">GraphletSamplingKernel</span></code></a><ul>
<li><a class="reference internal" href="#gauche.kernels.graph_kernels.GraphletSamplingKernel.__init__"><code class="docutils literal notranslate"><span class="pre">GraphletSamplingKernel.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#gauche.kernels.graph_kernels.NeighborhoodHashKernel"><code class="docutils literal notranslate"><span class="pre">NeighborhoodHashKernel</span></code></a><ul>
<li><a class="reference internal" href="#gauche.kernels.graph_kernels.NeighborhoodHashKernel.__init__"><code class="docutils literal notranslate"><span class="pre">NeighborhoodHashKernel.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#gauche.kernels.graph_kernels.RandomWalkKernel"><code class="docutils literal notranslate"><span class="pre">RandomWalkKernel</span></code></a><ul>
<li><a class="reference internal" href="#gauche.kernels.graph_kernels.RandomWalkKernel.__init__"><code class="docutils literal notranslate"><span class="pre">RandomWalkKernel.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#gauche.kernels.graph_kernels.RandomWalkLabeledKernel"><code class="docutils literal notranslate"><span class="pre">RandomWalkLabeledKernel</span></code></a><ul>
<li><a class="reference internal" href="#gauche.kernels.graph_kernels.RandomWalkLabeledKernel.__init__"><code class="docutils literal notranslate"><span class="pre">RandomWalkLabeledKernel.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#gauche.kernels.graph_kernels.ShortestPathKernel"><code class="docutils literal notranslate"><span class="pre">ShortestPathKernel</span></code></a><ul>
<li><a class="reference internal" href="#gauche.kernels.graph_kernels.ShortestPathKernel.__init__"><code class="docutils literal notranslate"><span class="pre">ShortestPathKernel.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#gauche.kernels.graph_kernels.ShortestPathLabeledKernel"><code class="docutils literal notranslate"><span class="pre">ShortestPathLabeledKernel</span></code></a><ul>
<li><a class="reference internal" href="#gauche.kernels.graph_kernels.ShortestPathLabeledKernel.__init__"><code class="docutils literal notranslate"><span class="pre">ShortestPathLabeledKernel.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#gauche.kernels.graph_kernels.VertexHistogramKernel"><code class="docutils literal notranslate"><span class="pre">VertexHistogramKernel</span></code></a><ul>
<li><a class="reference internal" href="#gauche.kernels.graph_kernels.VertexHistogramKernel.__init__"><code class="docutils literal notranslate"><span class="pre">VertexHistogramKernel.__init__()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#gauche.kernels.graph_kernels.WeisfeilerLehmanKernel"><code class="docutils literal notranslate"><span class="pre">WeisfeilerLehmanKernel</span></code></a><ul>
<li><a class="reference internal" href="#gauche.kernels.graph_kernels.WeisfeilerLehmanKernel.__init__"><code class="docutils literal notranslate"><span class="pre">WeisfeilerLehmanKernel.__init__()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-gauche.kernels.string_kernels">String Kernels</a><ul>
<li><a class="reference internal" href="#gauche.kernels.string_kernels.SubsequenceStringKernel"><code class="docutils literal notranslate"><span class="pre">SubsequenceStringKernel</span></code></a><ul>
<li><a class="reference internal" href="#gauche.kernels.string_kernels.SubsequenceStringKernel.__init__"><code class="docutils literal notranslate"><span class="pre">SubsequenceStringKernel.__init__()</span></code></a></li>
<li><a class="reference internal" href="#gauche.kernels.string_kernels.SubsequenceStringKernel.forward"><code class="docutils literal notranslate"><span class="pre">SubsequenceStringKernel.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
</aside>
</div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
<script src="../_static/doctools.js?v=888ff710"></script>
<script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
<script src="../_static/scripts/furo.js?v=32e29ea5"></script>
<script src="../_static/clipboard.min.js?v=a7894cd8"></script>
<script src="../_static/copybutton.js?v=f281be69"></script>
<script src="../_static/tabs.js?v=3ee01567"></script>
<script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
<script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
<script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</body>
</html>